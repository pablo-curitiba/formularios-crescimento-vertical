<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Formul√°rio - Crescimento Vertical 2025</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
const { useState } = React;

// √çcones SVG inline
const Icons = {
  Download: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
      <polyline points="7 10 12 15 17 10"></polyline>
      <line x1="12" y1="15" x2="12" y2="3"></line>
    </svg>
  ),
  Edit2: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
    </svg>
  ),
  Save: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
      <polyline points="17 21 17 13 7 13 7 21"></polyline>
      <polyline points="7 3 7 8 15 8"></polyline>
    </svg>
  ),
  Plus: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <line x1="12" y1="5" x2="12" y2="19"></line>
      <line x1="5" y1="12" x2="19" y2="12"></line>
    </svg>
  ),
  Trash2: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <polyline points="3 6 5 6 21 6"></polyline>
      <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
      <line x1="10" y1="11" x2="10" y2="17"></line>
      <line x1="14" y1="11" x2="14" y2="17"></line>
    </svg>
  ),
  FileText: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
      <polyline points="14 2 14 8 20 8"></polyline>
      <line x1="16" y1="13" x2="8" y2="13"></line>
      <line x1="16" y1="17" x2="8" y2="17"></line>
      <polyline points="10 9 9 9 8 9"></polyline>
    </svg>
  ),
  Printer: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <polyline points="6 9 6 2 18 2 18 9"></polyline>
      <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
      <rect x="6" y="14" width="12" height="8"></rect>
    </svg>
  ),
  Copy: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
    </svg>
  ),
  Table: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
      <line x1="3" y1="9" x2="21" y2="9"></line>
      <line x1="3" y1="15" x2="21" y2="15"></line>
      <line x1="9" y1="3" x2="9" y2="21"></line>
      <line x1="15" y1="3" x2="15" y2="21"></line>
    </svg>
  ),
  ChevronUp: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
  ),
  ChevronDown: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <polyline points="6 9 12 15 18 9"></polyline>
    </svg>
  )
};

function FormularioCV() {
  const [modoEdicao, setModoEdicao] = useState(true);
  
  const [config, setConfig] = useState({
    lei: '16.198/2023',
    grupoOcupacional: 'B√ÅSICO',
    tituloPrincipal: 'PREFEITURA MUNICIPAL DE CURITIBA',
    tituloFormulario: 'FORMUL√ÅRIO DO CRESCIMENTO VERTICAL 2025',
    pontosPorMes: 0.0556,
    limiteMaxMeses: 180,
    limiteTotal: 80.0, // NOVO: Limite total do formul√°rio
    // R√≥tulos edit√°veis para quadro completo
    rotulosCompleto: {
      criterio: 'Crit√©rio',
      pontUnit: 'Pont. Unit.',
      limite: 'Limite',
      qtd: 'Qtd',
      meses: 'Meses',
      base: 'Base',
      mult: 'Mult.',
      total: 'Total'
    },
    // R√≥tulos edit√°veis para quadro por tempo (ALTERADO: era "porAno")
    rotulosPorTempo: {
      criterio: 'Crit√©rio',
      pontTempo: 'Pont. por Tempo',
      limite: 'Limite',
      qtdTempo: 'Qtd (tempo)',
      total: 'Total',
      nomeQuadro: 'Por Tempo' // NOVO: Nome edit√°vel do tipo de quadro
    }
  });
  
  const [dados, setDados] = useState({
    servidor: '',
    matricula: '',
    cargo: '',
    unidade: '',
    lotacao: '',
    intersticio: ''
  });

  const leisDisponiveis = [
    { valor: '16.198/2023', cargo: 'Diversos Cargos' },
    { valor: '16.199/2023', cargo: 'Auditor Fiscal' },
    { valor: '16.200/2023', cargo: 'Procurador Municipal' },
    { valor: '16.201/2023', cargo: 'Professor de Educa√ß√£o Infantil' },
    { valor: '16.202/2023', cargo: 'Profissional do Magist√©rio' },
    { valor: '16.203/2023', cargo: 'Guarda Municipal' }
  ];

  // Sistema de quadros din√¢micos com op√ß√£o de colunas
  const [quadros, setQuadros] = useState([
    {
      id: 1,
      titulo: 'QUADRO A - EXEMPLO COM COLUNAS COMPLETAS',
      temColunas: true,
      limiteQuadro: '',
      criterios: [
        { id: 1, nome: 'Crit√©rio exemplo 1', pont: 5.0, lim: 10.0, qtd: '', meses: '' },
        { id: 2, nome: 'Crit√©rio exemplo 2', pont: 7.5, lim: 15.0, qtd: '', meses: '' }
      ]
    },
    {
      id: 2,
      titulo: 'QUADRO B - EXEMPLO COM COLUNAS POR TEMPO',
      temColunas: false,
      limiteQuadro: '',
      criterios: [
        { id: 1, nome: 'Item exemplo 1', pontTempo: 1.0, limItem: 5.0, qtdTempo: '' },
        { id: 2, nome: 'Item exemplo 2', pontTempo: 2.0, limItem: 10.0, qtdTempo: '' }
      ]
    }
  ]);

  // Estado para Crit√©rios de Desempate
  const [criteriosDesempate, setCriteriosDesempate] = useState([
    { id: 1, texto: 'Maior pontua√ß√£o do Quadro A ‚Äì Escolariza√ß√£o Formal.' },
    { id: 2, texto: 'Maior pontua√ß√£o do Quadro B ‚Äì Vida Funcional.' },
    { id: 3, texto: 'Maior pontua√ß√£o do Quadro C ‚Äì Produ√ß√£o de Conte√∫do.' },
    { id: 4, texto: 'Menor desconto do Quadro D - Inassiduidade.' },
    { id: 5, texto: 'Maior tempo de efetivo exerc√≠cio no cargo, contado em anos, meses e dias, sendo descontadas as licen√ßas sem vencimentos e disposi√ß√µes funcionais a √≥rg√£os ou entidades da Uni√£o, do Distrito Federal, dos Estados, de outros Munic√≠pios; √† C√¢mara Municipal de Curitiba; e √†s entidades integrantes da Administra√ß√£o Indireta do Munic√≠pio, salvo Autarquias e Funda√ß√µes de Direito P√∫blico do Munic√≠pio de Curitiba.' },
    { id: 6, texto: 'Maior tempo de efetivo exerc√≠cio na Administra√ß√£o Municipal, contado em anos, meses e dias, sendo descontadas as licen√ßas sem vencimentos e disposi√ß√µes funcionais a √≥rg√£os ou entidades da Uni√£o, do Distrito Federal, dos Estados, de outros Munic√≠pios; √† C√¢mara Municipal de Curitiba; e √†s entidades integrantes da Administra√ß√£o Indireta do Munic√≠pio, salvo Autarquias e Funda√ß√µes de Direito P√∫blico do Munic√≠pio de Curitiba.' },
    { id: 7, texto: 'Maior idade, contada em anos, meses e dias.' },
    { id: 8, texto: 'Persistindo o empate, ser√° realizado o desempate por meio de Sorteio P√∫blico, at√© o n√∫mero de vagas ofertadas por cargo.' }
  ]);

  const [mostrarDesempate, setMostrarDesempate] = useState(false);

  // Sistema de Templates e Biblioteca de Crit√©rios
  const [templates, setTemplates] = useState(() => {
    const saved = localStorage.getItem('cv2025_templates');
    return saved ? JSON.parse(saved) : {};
  });

  const [bibliotecaCriterios, setBibliotecaCriterios] = useState(() => {
    const saved = localStorage.getItem('cv2025_biblioteca_criterios');
    return saved ? JSON.parse(saved) : {
      'Quadro A': [],
      'Quadro B': [],
      'Quadro C': [],
      'Quadro D': [],
      'Quadro E': []
    };
  });

  const [templateAtual, setTemplateAtual] = useState('');
  const [mostrarGerenciador, setMostrarGerenciador] = useState(false);
  const [mostrarBiblioteca, setMostrarBiblioteca] = useState(false);
  const [quadroSelecionadoBiblioteca, setQuadroSelecionadoBiblioteca] = useState('Quadro A');
  const [novoCriterioTexto, setNovoCriterioTexto] = useState('');

  // Salvar templates no localStorage sempre que mudar
  React.useEffect(() => {
    localStorage.setItem('cv2025_templates', JSON.stringify(templates));
  }, [templates]);

  // Salvar biblioteca no localStorage sempre que mudar
  React.useEffect(() => {
    localStorage.setItem('cv2025_biblioteca_criterios', JSON.stringify(bibliotecaCriterios));
  }, [bibliotecaCriterios]);

  // Fun√ß√µes de manipula√ß√£o de quadros
  const addQuadro = (comColunas = false) => {
    const novoId = Math.max(...quadros.map(q => q.id), 0) + 1;
    setQuadros([
      ...quadros,
      {
        id: novoId,
        titulo: `QUADRO ${String.fromCharCode(64 + novoId)} - NOVO QUADRO`,
        temColunas: comColunas,
        limiteQuadro: '',
        criterios: []
      }
    ]);
  };

  const editQuadro = (id, campo, valor) => {
    setQuadros(quadros.map(q => 
      q.id === id ? { ...q, [campo]: valor } : q
    ));
  };

  const toggleColunas = (id) => {
    setQuadros(quadros.map(q => {
      if (q.id === id) {
        const novoTemColunas = !q.temColunas;
        const novosCriterios = q.criterios.map(c => {
          if (novoTemColunas) {
            // Mudando para colunas completas
            return { id: c.id, nome: c.nome, pont: 0, lim: 0, qtd: '', meses: '' };
          } else {
            // Mudando para colunas por tempo
            return { id: c.id, nome: c.nome, pontTempo: 0, limItem: 0, qtdTempo: '' };
          }
        });
        return { ...q, temColunas: novoTemColunas, criterios: novosCriterios };
      }
      return q;
    }));
  };

  const removeQuadro = (id) => {
    if (window.confirm('Tem certeza que deseja excluir este quadro?')) {
      setQuadros(quadros.filter(q => q.id !== id));
    }
  };

  const duplicarQuadro = (id) => {
    const quadroOriginal = quadros.find(q => q.id === id);
    if (!quadroOriginal) return;
    
    const novoId = Math.max(...quadros.map(q => q.id), 0) + 1;
    const criteriosDuplicados = quadroOriginal.criterios.map((c, idx) => ({
      ...c,
      id: idx + 1
    }));
    
    setQuadros([
      ...quadros,
      {
        ...quadroOriginal,
        id: novoId,
        titulo: quadroOriginal.titulo + ' (C√≥pia)',
        criterios: criteriosDuplicados
      }
    ]);
  };

  // Fun√ß√µes de manipula√ß√£o de crit√©rios
  const addCriterio = (idQuadro) => {
    setQuadros(quadros.map(q => {
      if (q.id === idQuadro) {
        const novoId = Math.max(...q.criterios.map(c => c.id), 0) + 1;
        const novoCriterio = { id: novoId, nome: 'Novo crit√©rio' };
        
        if (q.temColunas) {
          // Quadro com colunas completas
          novoCriterio.pont = 0;
          novoCriterio.lim = 0;
          novoCriterio.qtd = '';
          novoCriterio.meses = '';
        } else {
          // Quadro com colunas por tempo
          novoCriterio.pontTempo = 0;
          novoCriterio.limItem = 0;
          novoCriterio.qtdTempo = '';
        }
        
        return {
          ...q,
          criterios: [...q.criterios, novoCriterio]
        };
      }
      return q;
    }));
  };

  const editCriterio = (idQuadro, idCriterio, campo, valor) => {
    setQuadros(quadros.map(q => {
      if (q.id === idQuadro) {
        return {
          ...q,
          criterios: q.criterios.map(c =>
            c.id === idCriterio ? { ...c, [campo]: valor } : c
          )
        };
      }
      return q;
    }));
  };

  const removeCriterio = (idQuadro, idCriterio) => {
    setQuadros(quadros.map(q => {
      if (q.id === idQuadro) {
        return {
          ...q,
          criterios: q.criterios.filter(c => c.id !== idCriterio)
        };
      }
      return q;
    }));
  };

  // Fun√ß√µes para gerenciar Crit√©rios de Desempate
  const addCriterioDesempate = () => {
    const novoId = Math.max(...criteriosDesempate.map(c => c.id), 0) + 1;
    setCriteriosDesempate([
      ...criteriosDesempate,
      { id: novoId, texto: 'Novo crit√©rio de desempate' }
    ]);
  };

  const editCriterioDesempate = (id, novoTexto) => {
    setCriteriosDesempate(criteriosDesempate.map(c =>
      c.id === id ? { ...c, texto: novoTexto } : c
    ));
  };

  const removeCriterioDesempate = (id) => {
    if (window.confirm('Tem certeza que deseja excluir este crit√©rio de desempate?')) {
      setCriteriosDesempate(criteriosDesempate.filter(c => c.id !== id));
    }
  };

  const moveCriterioDesempate = (id, direcao) => {
    const index = criteriosDesempate.findIndex(c => c.id === id);
    if (
      (direcao === 'up' && index === 0) ||
      (direcao === 'down' && index === criteriosDesempate.length - 1)
    ) {
      return;
    }

    const newArray = [...criteriosDesempate];
    const newIndex = direcao === 'up' ? index - 1 : index + 1;
    [newArray[index], newArray[newIndex]] = [newArray[newIndex], newArray[index]];
    setCriteriosDesempate(newArray);
  };

  const exportarDesempatePDF = () => {
    // Criar conte√∫do HTML para o PDF de desempate
    let htmlDesempate = `
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crit√©rios de Desempate - Crescimento Vertical 2025</title>
    <style>
        @page {
            size: A4 portrait;
            margin: 20mm;
        }
        body {
            font-family: Arial, sans-serif;
            font-size: 11pt;
            line-height: 1.6;
            color: #000;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #1e40af;
            padding-bottom: 15px;
        }
        .header h1 {
            color: #1e40af;
            font-size: 18pt;
            margin: 0 0 5px 0;
        }
        .header h2 {
            color: #1e3a8a;
            font-size: 14pt;
            margin: 0;
            font-weight: normal;
        }
        .content {
            margin-top: 20px;
        }
        .criterio-item {
            margin-bottom: 15px;
            padding: 10px;
            border-left: 4px solid #1e40af;
            background-color: #f8f9fa;
        }
        .criterio-numero {
            font-weight: bold;
            color: #1e40af;
            margin-right: 5px;
        }
        .criterio-texto {
            text-align: justify;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>${config.tituloPrincipal}</h1>
        <h2>CRIT√âRIOS DE DESEMPATE</h2>
        <h2>${config.tituloFormulario}</h2>
    </div>
    <div class="content">
`;

    criteriosDesempate.forEach((criterio, index) => {
      htmlDesempate += `
        <div class="criterio-item">
            <span class="criterio-numero">${index + 1}.</span>
            <span class="criterio-texto">${criterio.texto}</span>
        </div>
`;
    });

    htmlDesempate += `
    </div>
</body>
</html>
`;

    const blob = new Blob([htmlDesempate], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `Criterios_Desempate_CV_2025_${new Date().toISOString().split('T')[0]}.html`;
    a.click();
    URL.revokeObjectURL(url);
  };

  // ========== FUN√á√ïES DE GERENCIAMENTO DE TEMPLATES ==========

  const salvarTemplate = () => {
    const nomeTemplate = prompt('Digite um nome para este template (Ex: Lei 16.198 - B√°sico):');
    if (!nomeTemplate || nomeTemplate.trim() === '') {
      alert('Nome inv√°lido!');
      return;
    }

    const dadosTemplate = {
      config: { ...config },
      dados: { ...dados },
      quadros: JSON.parse(JSON.stringify(quadros)),
      criteriosDesempate: JSON.parse(JSON.stringify(criteriosDesempate)),
      dataCriacao: new Date().toISOString(),
      dataModificacao: new Date().toISOString()
    };

    setTemplates({
      ...templates,
      [nomeTemplate]: dadosTemplate
    });

    setTemplateAtual(nomeTemplate);
    alert(`Template "${nomeTemplate}" salvo com sucesso!`);
  };

  const carregarTemplate = (nomeTemplate) => {
    if (!templates[nomeTemplate]) {
      alert('Template n√£o encontrado!');
      return;
    }

    const confirmacao = window.confirm(
      `Deseja carregar o template "${nomeTemplate}"?\n\nISTO IR√Å SUBSTITUIR TODOS OS DADOS ATUAIS!`
    );

    if (!confirmacao) return;

    const template = templates[nomeTemplate];
    setConfig(template.config);
    setDados(template.dados);
    setQuadros(JSON.parse(JSON.stringify(template.quadros)));
    setCriteriosDesempate(JSON.parse(JSON.stringify(template.criteriosDesempate)));
    setTemplateAtual(nomeTemplate);

    alert(`Template "${nomeTemplate}" carregado com sucesso!`);
  };

  const atualizarTemplateAtual = () => {
    if (!templateAtual || !templates[templateAtual]) {
      alert('Nenhum template carregado para atualizar!');
      return;
    }

    const confirmacao = window.confirm(
      `Deseja atualizar o template "${templateAtual}" com os dados atuais?`
    );

    if (!confirmacao) return;

    const dadosTemplate = {
      config: { ...config },
      dados: { ...dados },
      quadros: JSON.parse(JSON.stringify(quadros)),
      criteriosDesempate: JSON.parse(JSON.stringify(criteriosDesempate)),
      dataCriacao: templates[templateAtual].dataCriacao,
      dataModificacao: new Date().toISOString()
    };

    setTemplates({
      ...templates,
      [templateAtual]: dadosTemplate
    });

    alert(`Template "${templateAtual}" atualizado com sucesso!`);
  };

  const excluirTemplate = (nomeTemplate) => {
    const confirmacao = window.confirm(
      `Tem certeza que deseja excluir o template "${nomeTemplate}"?\n\nEsta a√ß√£o n√£o pode ser desfeita!`
    );

    if (!confirmacao) return;

    const novosTemplates = { ...templates };
    delete novosTemplates[nomeTemplate];
    setTemplates(novosTemplates);

    if (templateAtual === nomeTemplate) {
      setTemplateAtual('');
    }

    alert(`Template "${nomeTemplate}" exclu√≠do com sucesso!`);
  };

  const duplicarTemplate = (nomeTemplate) => {
    if (!templates[nomeTemplate]) return;

    const novoNome = prompt(`Digite um nome para a c√≥pia do template:`, `${nomeTemplate} (C√≥pia)`);
    if (!novoNome || novoNome.trim() === '') return;

    const templateOriginal = templates[nomeTemplate];
    const novoTemplate = {
      ...JSON.parse(JSON.stringify(templateOriginal)),
      dataCriacao: new Date().toISOString(),
      dataModificacao: new Date().toISOString()
    };

    setTemplates({
      ...templates,
      [novoNome]: novoTemplate
    });

    alert(`Template duplicado como "${novoNome}"!`);
  };

  // ========== FUN√á√ïES DE BIBLIOTECA DE CRIT√âRIOS ==========

  const adicionarCriterioNaBiblioteca = () => {
    if (!novoCriterioTexto.trim()) {
      alert('Digite um crit√©rio antes de adicionar!');
      return;
    }

    const novaBiblioteca = { ...bibliotecaCriterios };
    novaBiblioteca[quadroSelecionadoBiblioteca].push({
      id: Date.now(),
      texto: novoCriterioTexto,
      dataCriacao: new Date().toISOString()
    });

    setBibliotecaCriterios(novaBiblioteca);
    setNovoCriterioTexto('');
    alert(`Crit√©rio adicionado √† biblioteca do ${quadroSelecionadoBiblioteca}!`);
  };

  const editarCriterioBiblioteca = (quadro, idCriterio, novoTexto) => {
    const novaBiblioteca = { ...bibliotecaCriterios };
    const criterioIndex = novaBiblioteca[quadro].findIndex(c => c.id === idCriterio);
    if (criterioIndex !== -1) {
      novaBiblioteca[quadro][criterioIndex].texto = novoTexto;
      setBibliotecaCriterios(novaBiblioteca);
    }
  };

  const removerCriterioBiblioteca = (quadro, idCriterio) => {
    if (!window.confirm('Deseja remover este crit√©rio da biblioteca?')) return;

    const novaBiblioteca = { ...bibliotecaCriterios };
    novaBiblioteca[quadro] = novaBiblioteca[quadro].filter(c => c.id !== idCriterio);
    setBibliotecaCriterios(novaBiblioteca);
  };

  const inserirCriterioDaBiblioteca = (quadroId, criterioTexto) => {
    setQuadros(quadros.map(q => {
      if (q.id === quadroId) {
        const novoId = Math.max(...q.criterios.map(c => c.id), 0) + 1;
        const novoCriterio = { id: novoId, nome: criterioTexto };
        
        if (q.temColunas) {
          novoCriterio.pont = 0;
          novoCriterio.lim = 0;
          novoCriterio.qtd = '';
          novoCriterio.meses = '';
        } else {
          novoCriterio.pontTempo = 0;
          novoCriterio.limItem = 0;
          novoCriterio.qtdTempo = '';
        }
        
        return {
          ...q,
          criterios: [...q.criterios, novoCriterio]
        };
      }
      return q;
    }));

    alert('Crit√©rio inserido no quadro!');
  };

  // Fun√ß√£o de c√°lculo para crit√©rios com colunas completas
  const calcularCriterio = (criterio) => {
    const pont = parseFloat(criterio.pont || 0);
    const lim = parseFloat(criterio.lim || 0);
    const qtd = parseFloat(criterio.qtd || 0);
    const meses = parseFloat(criterio.meses || 0);
    
    const ptsBase = Math.min(pont * qtd, lim);
    const ptsMeses = Math.min(meses * config.pontosPorMes, config.limiteMaxMeses);
    const total = ptsBase + ptsMeses;
    
    return { ptsBase, ptsMeses, total };
  };

  // Fun√ß√£o de c√°lculo para crit√©rios por tempo
  const calcularCriterioPorTempo = (criterio) => {
    const pontTempo = parseFloat(criterio.pontTempo || 0);
    const limItem = parseFloat(criterio.limItem || 0);
    const qtdTempo = parseFloat(criterio.qtdTempo || 0);
    
    const total = Math.min(pontTempo * qtdTempo, limItem);
    
    return total;
  };

  // Calcular total de um quadro
  const calcularTotalQuadro = (quadro) => {
    if (quadro.temColunas) {
      return quadro.criterios.reduce((acc, crit) => {
        const calc = calcularCriterio(crit);
        return acc + calc.total;
      }, 0);
    } else {
      return quadro.criterios.reduce((acc, crit) => {
        const total = calcularCriterioPorTempo(crit);
        return acc + total;
      }, 0);
    }
  };

  // NOVO: Calcular total geral do formul√°rio
  const calcularTotalGeral = () => {
    return quadros.reduce((acc, quadro) => acc + calcularTotalQuadro(quadro), 0);
  };

  const handleLeiChange = (novaLei) => {
    const leiSelecionada = leisDisponiveis.find(l => l.valor === novaLei);
    setConfig({...config, lei: novaLei});
    if (leiSelecionada) {
      setDados({...dados, cargo: leiSelecionada.cargo});
    }
  };

  // Fun√ß√µes de exporta√ß√£o
  const exportarHTML = () => {
    const htmlContent = document.documentElement.outerHTML;
    const blob = new Blob([htmlContent], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `Formulario_CV_${dados.servidor || 'servidor'}_${new Date().toISOString().split('T')[0]}.html`;
    a.click();
    URL.revokeObjectURL(url);
  };

  const exportarJSON = () => {
    const data = { config, dados, quadros };
    const json = JSON.stringify(data, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `Formulario_CV_${dados.servidor || 'servidor'}_${new Date().toISOString().split('T')[0]}.json`;
    a.click();
    URL.revokeObjectURL(url);
  };

  const copiarTexto = () => {
    let texto = `${config.tituloPrincipal}\n`;
    texto += `${config.tituloFormulario}\n\n`;
    texto += `SERVIDOR: ${dados.servidor}\n`;
    texto += `MATR√çCULA: ${dados.matricula}\n`;
    texto += `CARGO: ${dados.cargo}\n`;
    texto += `UNIDADE: ${dados.unidade}\n`;
    texto += `LOTA√á√ÉO: ${dados.lotacao}\n`;
    texto += `INTERST√çCIO: ${dados.intersticio}\n\n`;
    
    quadros.forEach((quadro) => {
      texto += `\n${quadro.titulo}\n`;
      texto += `${'='.repeat(quadro.titulo.length)}\n`;
      quadro.criterios.forEach((crit, idx) => {
        texto += `${idx + 1}. ${crit.nome}`;
        if (quadro.temColunas) {
          const calc = calcularCriterio(crit);
          texto += ` - Total: ${calc.total.toFixed(1)} pts`;
        } else {
          const total = calcularCriterioPorTempo(crit);
          texto += ` - Total: ${total.toFixed(1)} pts`;
        }
        texto += '\n';
      });
      texto += `TOTAL DO QUADRO: ${calcularTotalQuadro(quadro).toFixed(1)} pts`;
      if (quadro.limiteQuadro) {
        texto += ` | LIMITE: ${quadro.limiteQuadro}`;
      }
      texto += '\n';
    });

    texto += `\n${'='.repeat(50)}\n`;
    texto += `TOTAL GERAL DO FORMUL√ÅRIO: ${calcularTotalGeral().toFixed(1)} / ${config.limiteTotal.toFixed(1)} pontos\n`;

    navigator.clipboard.writeText(texto).then(() => {
      alert('Texto copiado para a √°rea de transfer√™ncia!');
    });
  };

  const imprimir = () => {
    window.print();
  };

  return (
    <div className="min-h-screen bg-gray-100 py-8 px-4">
      <style>{`
        @media print {
          body { 
            margin: 0; 
            padding: 0; 
            background: white;
            font-size: 9pt;
          }
          .no-print { display: none !important; }
          .hide-on-export { display: none !important; }
          .hide-on-print { display: none !important; }
          .container { 
            max-width: 100% !important; 
            margin: 0 !important; 
            padding: 0 !important; 
          }
          @page { 
            size: A4 portrait; 
            margin: 10mm 8mm;
          }
          /* Otimiza√ß√µes cr√≠ticas para A4 */
          * {
            box-sizing: border-box;
          }
          table { 
            page-break-inside: auto;
            font-size: 7pt;
            border-collapse: collapse;
            width: 100%;
          }
          tr { 
            page-break-inside: avoid; 
            page-break-after: auto; 
          }
          thead { 
            display: table-header-group; 
          }
          .bg-white {
            box-shadow: none !important;
          }
          /* Ajustes de espa√ßamento para A4 */
          .p-6 { padding: 0.5rem !important; }
          .p-4 { padding: 0.4rem !important; }
          .p-3 { padding: 0.3rem !important; }
          .p-2 { padding: 0.2rem !important; }
          .mb-6 { margin-bottom: 0.5rem !important; }
          .mb-4 { margin-bottom: 0.3rem !important; }
          .mb-3 { margin-bottom: 0.25rem !important; }
          .gap-4 { gap: 0.3rem !important; }
          /* T√≠tulos mais compactos */
          h1 { font-size: 16pt !important; margin: 0.3rem 0 !important; line-height: 1.2 !important; }
          h2 { font-size: 14pt !important; margin: 0.2rem 0 !important; line-height: 1.2 !important; }
          /* Tabelas mais compactas */
          th, td { 
            padding: 0.15rem 0.25rem !important;
            font-size: 8pt !important;
            line-height: 1.2 !important;
          }
          /* Bordas finas para impress√£o */
          .border, .border-2 { border-width: 1px !important; }
          /* Grid de dados compacto */
          .grid { gap: 0.25rem !important; }
          /* Evitar quebra de quadros */
          .quadro-container {
            page-break-inside: avoid;
          }
          /* Rodap√© total compacto */
          .total-geral-container {
            margin-top: 0.5rem !important;
            padding: 0.4rem !important;
          }
          /* Inputs na impress√£o */
          input {
            border: none !important;
            border-bottom: 1px solid #ccc !important;
            padding: 0 !important;
            font-size: 8pt !important;
          }
        }
        @media screen {
          /* Estilos normais para tela */
        }
      `}</style>

      <div className="max-w-7xl mx-auto">
        {/* Barra de ferramentas */}
        <div className="bg-white rounded-lg shadow-md p-4 mb-6 no-print">
          <div className="flex flex-wrap gap-3 items-center justify-between">
            <h1 className="text-2xl font-bold text-blue-900">Editor de Formul√°rio - CV 2025</h1>
            <div className="flex flex-wrap gap-2">
              <button
                onClick={() => setModoEdicao(!modoEdicao)}
                className={`px-4 py-2 rounded font-semibold flex items-center gap-2 ${
                  modoEdicao ? 'bg-green-600 hover:bg-green-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'
                }`}
              >
                {modoEdicao ? <><Icons.Save /> Visualizar</> : <><Icons.Edit2 /> Editar</>}
              </button>
              <button
                onClick={exportarHTML}
                className="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded font-semibold flex items-center gap-2"
              >
                <Icons.Download /> HTML
              </button>
              <button
                onClick={exportarJSON}
                className="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded font-semibold flex items-center gap-2"
              >
                <Icons.FileText /> JSON
              </button>
              <button
                onClick={copiarTexto}
                className="px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded font-semibold"
              >
                Copiar Texto
              </button>
              <button
                onClick={imprimir}
                className="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded font-semibold flex items-center gap-2"
              >
                <Icons.Printer /> Imprimir
              </button>
              <button
                onClick={() => setMostrarDesempate(!mostrarDesempate)}
                className={`px-4 py-2 ${mostrarDesempate ? 'bg-orange-600 hover:bg-orange-700' : 'bg-amber-600 hover:bg-amber-700'} text-white rounded font-semibold flex items-center gap-2`}
              >
                {mostrarDesempate ? '‚úì Desempate' : 'Crit√©rios Desempate'}
              </button>
            </div>
          </div>
          
          {/* Segunda linha de bot√µes - Sistema de Templates */}
          <div className="flex flex-wrap gap-2 items-center mt-3 p-4 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg border-2 border-purple-200">
            <div className="flex items-center gap-2 mr-4">
              <span className="font-bold text-purple-900">üìö Templates:</span>
              {templateAtual && (
                <span className="px-3 py-1 bg-purple-600 text-white rounded-full text-sm font-semibold">
                  {templateAtual}
                </span>
              )}
            </div>
            <button
              onClick={salvarTemplate}
              className="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded font-semibold flex items-center gap-2"
              title="Salvar formul√°rio atual como template"
            >
              <Icons.Save /> Salvar Template
            </button>
            <button
              onClick={() => setMostrarGerenciador(!mostrarGerenciador)}
              className={`px-4 py-2 ${mostrarGerenciador ? 'bg-purple-700' : 'bg-purple-600 hover:bg-purple-700'} text-white rounded font-semibold flex items-center gap-2`}
              title="Gerenciar templates salvos"
            >
              <Icons.FileText /> {mostrarGerenciador ? 'Fechar' : 'Gerenciar'} ({Object.keys(templates).length})
            </button>
            {templateAtual && (
              <button
                onClick={atualizarTemplateAtual}
                className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-semibold flex items-center gap-2"
                title="Atualizar template atual com dados atuais"
              >
                <Icons.Edit2 /> Atualizar Atual
              </button>
            )}
            <button
              onClick={() => setMostrarBiblioteca(!mostrarBiblioteca)}
              className={`px-4 py-2 ${mostrarBiblioteca ? 'bg-indigo-700' : 'bg-indigo-600 hover:bg-indigo-700'} text-white rounded font-semibold flex items-center gap-2`}
              title="Biblioteca de crit√©rios reutiliz√°veis"
            >
              üìñ {mostrarBiblioteca ? 'Fechar' : 'Biblioteca'}
            </button>
          </div>
        </div>

        {/* Painel de Gerenciamento de Templates */}
        {mostrarGerenciador && (
          <div className="bg-white rounded-lg shadow-md p-6 mb-6 border-4 border-purple-500">
            <div className="flex justify-between items-center mb-4">
              <h2 className="text-2xl font-bold text-purple-900">Gerenciador de Templates</h2>
              <button
                onClick={() => setMostrarGerenciador(false)}
                className="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded font-semibold"
              >
                Fechar
              </button>
            </div>

            {Object.keys(templates).length === 0 ? (
              <div className="text-center py-12 bg-purple-50 rounded-lg">
                <p className="text-gray-600 text-lg mb-4">Nenhum template salvo ainda</p>
                <p className="text-gray-500 text-sm">Configure um formul√°rio e clique em "Salvar Template" para criar seu primeiro template!</p>
              </div>
            ) : (
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                {Object.entries(templates).map(([nome, template]) => (
                  <div key={nome} className={`p-4 rounded-lg border-2 ${templateAtual === nome ? 'border-purple-600 bg-purple-50' : 'border-gray-300 bg-white'} shadow`}>
                    <div className="flex justify-between items-start mb-3">
                      <div className="flex-1">
                        <h3 className="font-bold text-lg text-purple-900 mb-1">{nome}</h3>
                        {templateAtual === nome && (
                          <span className="inline-block px-2 py-1 bg-purple-600 text-white text-xs rounded">
                            ATIVO
                          </span>
                        )}
                      </div>
                    </div>
                    
                    <div className="text-sm text-gray-600 mb-3 space-y-1">
                      <p><strong>Lei:</strong> {template.config.lei}</p>
                      <p><strong>Grupo:</strong> {template.config.grupoOcupacional}</p>
                      <p><strong>Quadros:</strong> {template.quadros.length}</p>
                      <p><strong>Criado:</strong> {new Date(template.dataCriacao).toLocaleDateString('pt-BR')}</p>
                      <p><strong>Modificado:</strong> {new Date(template.dataModificacao).toLocaleDateString('pt-BR')}</p>
                    </div>

                    <div className="flex flex-wrap gap-2">
                      <button
                        onClick={() => carregarTemplate(nome)}
                        className="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm font-semibold"
                      >
                        Carregar
                      </button>
                      <button
                        onClick={() => duplicarTemplate(nome)}
                        className="px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm font-semibold"
                      >
                        Duplicar
                      </button>
                      <button
                        onClick={() => excluirTemplate(nome)}
                        className="px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm font-semibold"
                      >
                        Excluir
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            )}

            <div className="mt-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
              <h4 className="font-bold text-blue-900 mb-2">Como usar Templates:</h4>
              <ul className="text-sm text-blue-800 space-y-1 list-disc list-inside">
                <li><strong>Salvar Template:</strong> Configure seu formul√°rio e clique em "Salvar Template"</li>
                <li><strong>Carregar:</strong> Clique em "Carregar" para usar um template salvo</li>
                <li><strong>Atualizar Atual:</strong> Modifique o template ativo e clique em "Atualizar Atual"</li>
                <li><strong>Duplicar:</strong> Crie uma c√≥pia de um template para fazer varia√ß√µes</li>
                <li><strong>Templates s√£o salvos no navegador:</strong> Funcionam mesmo ap√≥s fechar a p√°gina</li>
              </ul>
            </div>
          </div>
        )}

        {/* Painel de Biblioteca de Crit√©rios */}
        {mostrarBiblioteca && (
          <div className="bg-white rounded-lg shadow-md p-6 mb-6 border-4 border-indigo-500">
            <div className="flex justify-between items-center mb-4">
              <h2 className="text-2xl font-bold text-indigo-900">Biblioteca de Crit√©rios Reutiliz√°veis</h2>
              <button
                onClick={() => setMostrarBiblioteca(false)}
                className="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded font-semibold"
              >
                Fechar
              </button>
            </div>

            {/* Seletor de Quadro */}
            <div className="mb-4">
              <label className="block text-sm font-semibold mb-2 text-indigo-900">Selecione o Quadro:</label>
              <select
                value={quadroSelecionadoBiblioteca}
                onChange={(e) => setQuadroSelecionadoBiblioteca(e.target.value)}
                className="w-full px-4 py-2 border-2 border-indigo-300 rounded-lg font-semibold"
              >
                {Object.keys(bibliotecaCriterios).map(quadro => (
                  <option key={quadro} value={quadro}>{quadro}</option>
                ))}
              </select>
            </div>

            {/* Adicionar novo crit√©rio */}
            <div className="mb-6 p-4 bg-indigo-50 rounded-lg border-2 border-indigo-200">
              <label className="block text-sm font-semibold mb-2 text-indigo-900">Adicionar Novo Crit√©rio ao {quadroSelecionadoBiblioteca}:</label>
              <div className="flex gap-2">
                <input
                  type="text"
                  value={novoCriterioTexto}
                  onChange={(e) => setNovoCriterioTexto(e.target.value)}
                  onKeyPress={(e) => e.key === 'Enter' && adicionarCriterioNaBiblioteca()}
                  placeholder="Digite o texto do crit√©rio..."
                  className="flex-1 px-4 py-2 border rounded-lg"
                />
                <button
                  onClick={adicionarCriterioNaBiblioteca}
                  className="px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold flex items-center gap-2"
                >
                  <Icons.Plus /> Adicionar
                </button>
              </div>
            </div>

            {/* Lista de crit√©rios da biblioteca */}
            <div className="space-y-3">
              <h3 className="font-bold text-indigo-900 text-lg">
                Crit√©rios salvos no {quadroSelecionadoBiblioteca} ({bibliotecaCriterios[quadroSelecionadoBiblioteca].length})
              </h3>
              
              {bibliotecaCriterios[quadroSelecionadoBiblioteca].length === 0 ? (
                <div className="text-center py-8 bg-gray-50 rounded-lg">
                  <p className="text-gray-500">Nenhum crit√©rio salvo neste quadro</p>
                </div>
              ) : (
                bibliotecaCriterios[quadroSelecionadoBiblioteca].map((criterio) => (
                  <div key={criterio.id} className="p-4 bg-white rounded-lg border-2 border-indigo-200 shadow">
                    <div className="flex gap-3 items-start">
                      <textarea
                        value={criterio.texto}
                        onChange={(e) => editarCriterioBiblioteca(quadroSelecionadoBiblioteca, criterio.id, e.target.value)}
                        className="flex-1 px-3 py-2 border rounded resize-none"
                        rows="2"
                      />
                      <div className="flex flex-col gap-2">
                        <button
                          onClick={() => removerCriterioBiblioteca(quadroSelecionadoBiblioteca, criterio.id)}
                          className="px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded flex items-center gap-1"
                          title="Remover da biblioteca"
                        >
                          <Icons.Trash2 />
                        </button>
                        {quadros.length > 0 && (
                          <select
                            onChange={(e) => {
                              if (e.target.value) {
                                inserirCriterioDaBiblioteca(parseInt(e.target.value), criterio.texto);
                                e.target.value = '';
                              }
                            }}
                            className="px-2 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-xs"
                            defaultValue=""
                          >
                            <option value="">Inserir em...</option>
                            {quadros.map(q => (
                              <option key={q.id} value={q.id}>{q.titulo}</option>
                            ))}
                          </select>
                        )}
                      </div>
                    </div>
                    <p className="text-xs text-gray-500 mt-2">
                      Criado em: {new Date(criterio.dataCriacao).toLocaleString('pt-BR')}
                    </p>
                  </div>
                ))
              )}
            </div>

            <div className="mt-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
              <h4 className="font-bold text-blue-900 mb-2">Como usar a Biblioteca:</h4>
              <ul className="text-sm text-blue-800 space-y-1 list-disc list-inside">
                <li><strong>Adicionar:</strong> Digite um crit√©rio e clique em "Adicionar" para salvar na biblioteca</li>
                <li><strong>Editar:</strong> Modifique o texto diretamente - as mudan√ßas s√£o salvas automaticamente</li>
                <li><strong>Inserir:</strong> Use o dropdown "Inserir em..." para adicionar o crit√©rio a um quadro do formul√°rio</li>
                <li><strong>Organiza√ß√£o:</strong> Separe crit√©rios por tipo de quadro (A, B, C, D, E)</li>
                <li><strong>Reutiliza√ß√£o:</strong> Crit√©rios podem ser inseridos em m√∫ltiplos formul√°rios/templates</li>
              </ul>
            </div>
          </div>
        )}

        {/* Painel de Crit√©rios de Desempate */}
        {mostrarDesempate && (
          <div className="bg-white rounded-lg shadow-md p-6 mb-6 border-4 border-amber-500">
            <div className="flex justify-between items-center mb-4">
              <h2 className="text-2xl font-bold text-amber-900">Crit√©rios de Desempate</h2>
              <div className="flex gap-2">
                <button
                  onClick={addCriterioDesempate}
                  className="px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded font-semibold flex items-center gap-2"
                >
                  <Icons.Plus /> Adicionar Crit√©rio
                </button>
                <button
                  onClick={exportarDesempatePDF}
                  className="px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded font-semibold flex items-center gap-2"
                >
                  <Icons.Download /> Exportar HTML
                </button>
                <button
                  onClick={() => setMostrarDesempate(false)}
                  className="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded font-semibold"
                >
                  Fechar
                </button>
              </div>
            </div>

            <div className="bg-amber-50 rounded-lg p-4 border-2 border-amber-200">
              <h3 className="font-bold text-amber-900 mb-3 text-lg">Lista de Crit√©rios:</h3>
              
              {criteriosDesempate.length === 0 && (
                <div className="text-center py-8 text-gray-500">
                  Nenhum crit√©rio de desempate cadastrado.
                  <button
                    onClick={addCriterioDesempate}
                    className="ml-3 px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded"
                  >
                    Adicionar Primeiro Crit√©rio
                  </button>
                </div>
              )}

              {criteriosDesempate.map((criterio, index) => (
                <div key={criterio.id} className="mb-4 bg-white rounded-lg shadow p-4 border-l-4 border-amber-500">
                  <div className="flex items-start gap-3">
                    <div className="flex flex-col gap-1">
                      <button
                        onClick={() => moveCriterioDesempate(criterio.id, 'up')}
                        disabled={index === 0}
                        className={`px-2 py-1 rounded text-xs ${
                          index === 0
                            ? 'bg-gray-200 text-gray-400 cursor-not-allowed'
                            : 'bg-blue-500 hover:bg-blue-600 text-white'
                        }`}
                        title="Mover para cima"
                      >
                        ‚ñ≤
                      </button>
                      <button
                        onClick={() => moveCriterioDesempate(criterio.id, 'down')}
                        disabled={index === criteriosDesempate.length - 1}
                        className={`px-2 py-1 rounded text-xs ${
                          index === criteriosDesempate.length - 1
                            ? 'bg-gray-200 text-gray-400 cursor-not-allowed'
                            : 'bg-blue-500 hover:bg-blue-600 text-white'
                        }`}
                        title="Mover para baixo"
                      >
                        ‚ñº
                      </button>
                    </div>
                    
                    <div className="flex-1">
                      <div className="flex items-start gap-2 mb-2">
                        <span className="text-amber-900 font-bold text-lg min-w-[30px]">{index + 1}.</span>
                        <textarea
                          value={criterio.texto}
                          onChange={(e) => editCriterioDesempate(criterio.id, e.target.value)}
                          className="flex-1 px-3 py-2 border rounded resize-none"
                          rows="3"
                          placeholder="Digite o crit√©rio de desempate..."
                        />
                      </div>
                    </div>

                    <button
                      onClick={() => removeCriterioDesempate(criterio.id)}
                      className="px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded flex items-center gap-1"
                      title="Excluir crit√©rio"
                    >
                      <Icons.Trash2 />
                    </button>
                  </div>
                </div>
              ))}
            </div>

            <div className="mt-4 p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
              <h4 className="font-bold text-blue-900 mb-2">Instru√ß√µes:</h4>
              <ul className="text-sm text-blue-800 space-y-1 list-disc list-inside">
                <li>Use os bot√µes ‚ñ≤‚ñº para reordenar os crit√©rios</li>
                <li>Edite o texto diretamente no campo de cada crit√©rio</li>
                <li>Clique em "Adicionar Crit√©rio" para incluir novos itens</li>
                <li>Clique em "Exportar HTML" para gerar documento separado para impress√£o/PDF</li>
                <li>Os crit√©rios s√£o independentes do formul√°rio principal</li>
              </ul>
            </div>
          </div>
        )}

        {/* Configura√ß√µes */}
        {modoEdicao && (
          <div className="bg-white rounded-lg shadow-md p-4 mb-6 no-print">
            <h2 className="text-xl font-bold mb-4 text-blue-900">Configura√ß√µes do Formul√°rio</h2>
            
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label className="block text-sm font-semibold mb-1">T√≠tulo Principal:</label>
                <input
                  type="text"
                  value={config.tituloPrincipal}
                  onChange={(e) => setConfig({...config, tituloPrincipal: e.target.value})}
                  className="w-full px-3 py-2 border rounded"
                />
              </div>
              <div>
                <label className="block text-sm font-semibold mb-1">T√≠tulo do Formul√°rio:</label>
                <input
                  type="text"
                  value={config.tituloFormulario}
                  onChange={(e) => setConfig({...config, tituloFormulario: e.target.value})}
                  className="w-full px-3 py-2 border rounded"
                />
              </div>
              <div>
                <label className="block text-sm font-semibold mb-1">Lei:</label>
                <select
                  value={config.lei}
                  onChange={(e) => handleLeiChange(e.target.value)}
                  className="w-full px-3 py-2 border rounded"
                >
                  {leisDisponiveis.map(l => (
                    <option key={l.valor} value={l.valor}>
                      {l.valor} {l.cargo && `- ${l.cargo}`}
                    </option>
                  ))}
                </select>
              </div>
              <div>
                <label className="block text-sm font-semibold mb-1">Grupo Ocupacional:</label>
                <select
                  value={config.grupoOcupacional}
                  onChange={(e) => setConfig({...config, grupoOcupacional: e.target.value})}
                  className="w-full px-3 py-2 border rounded"
                >
                  <option value="B√ÅSICO">B√ÅSICO</option>
                  <option value="M√âDIO">M√âDIO</option>
                  <option value="SUPERIOR">SUPERIOR</option>
                </select>
              </div>
              <div>
                <label className="block text-sm font-semibold mb-1">Pontos por M√™s:</label>
                <input
                  type="number"
                  step="0.0001"
                  value={config.pontosPorMes}
                  onChange={(e) => setConfig({...config, pontosPorMes: parseFloat(e.target.value) || 0})}
                  className="w-full px-3 py-2 border rounded"
                />
              </div>
              <div>
                <label className="block text-sm font-semibold mb-1">Limite M√°x. Meses:</label>
                <input
                  type="number"
                  step="0.1"
                  value={config.limiteMaxMeses}
                  onChange={(e) => setConfig({...config, limiteMaxMeses: parseFloat(e.target.value) || 0})}
                  className="w-full px-3 py-2 border rounded"
                />
              </div>
              <div className="md:col-span-2">
                <label className="block text-sm font-semibold mb-1 text-blue-900">Limite Total do Formul√°rio:</label>
                <input
                  type="number"
                  step="0.1"
                  value={config.limiteTotal}
                  onChange={(e) => setConfig({...config, limiteTotal: parseFloat(e.target.value) || 0})}
                  className="w-full px-3 py-2 border-2 border-blue-300 rounded font-bold"
                  placeholder="Ex: 80.0"
                />
              </div>
            </div>

            {/* Configura√ß√£o de R√≥tulos */}
            <div className="mt-6 pt-6 border-t-2 border-gray-300">
              <h3 className="text-lg font-bold mb-4 text-blue-900">Configurar R√≥tulos das Colunas</h3>
              
              {/* R√≥tulos Quadro Completo */}
              <div className="mb-4">
                <h4 className="font-semibold mb-2 text-gray-700">Quadro Completo:</h4>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                  {Object.entries(config.rotulosCompleto).map(([key, value]) => (
                    <div key={key}>
                      <label className="block text-xs font-semibold mb-1 text-gray-600 capitalize">
                        {key}:
                      </label>
                      <input
                        type="text"
                        value={value}
                        onChange={(e) => setConfig({
                          ...config,
                          rotulosCompleto: { ...config.rotulosCompleto, [key]: e.target.value }
                        })}
                        className="w-full px-2 py-1 border rounded text-sm"
                      />
                    </div>
                  ))}
                </div>
              </div>

              {/* R√≥tulos Quadro Por Tempo */}
              <div>
                <h4 className="font-semibold mb-2 text-gray-700">Quadro Por Tempo:</h4>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                  {Object.entries(config.rotulosPorTempo).map(([key, value]) => (
                    <div key={key}>
                      <label className="block text-xs font-semibold mb-1 text-gray-600 capitalize">
                        {key === 'nomeQuadro' ? 'Nome do Quadro' : key}:
                      </label>
                      <input
                        type="text"
                        value={value}
                        onChange={(e) => setConfig({
                          ...config,
                          rotulosPorTempo: { ...config.rotulosPorTempo, [key]: e.target.value }
                        })}
                        className="w-full px-2 py-1 border rounded text-sm"
                      />
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Bot√µes adicionar quadro */}
        {modoEdicao && (
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 no-print">
            <button
              onClick={() => addQuadro(true)}
              className="py-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg font-bold text-lg flex items-center justify-center gap-2 shadow-lg"
            >
              <Icons.Table /> ADICIONAR QUADRO COMPLETO
            </button>
            <button
              onClick={() => addQuadro(false)}
              className="py-4 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white rounded-lg font-bold text-lg flex items-center justify-center gap-2 shadow-lg"
            >
              <Icons.Plus /> ADICIONAR QUADRO {config.rotulosPorTempo.nomeQuadro.toUpperCase()}
            </button>
          </div>
        )}

        {/* Formul√°rio principal */}
        <div className="bg-white rounded-lg shadow-lg p-6">
          {/* Cabe√ßalho */}
          <div className="text-center mb-6 border-b-2 border-blue-900 pb-4">
            {modoEdicao ? (
              <>
                <input
                  type="text"
                  value={config.tituloPrincipal}
                  onChange={(e) => setConfig({...config, tituloPrincipal: e.target.value})}
                  className="text-2xl font-bold mb-2 w-full text-center border-b-2 border-blue-300 px-2 py-1"
                />
                <input
                  type="text"
                  value={config.tituloFormulario}
                  onChange={(e) => setConfig({...config, tituloFormulario: e.target.value})}
                  className="text-xl text-blue-800 w-full text-center border-b border-blue-200 px-2 py-1"
                />
              </>
            ) : (
              <>
                <h1 className="text-2xl font-bold mb-2">{config.tituloPrincipal}</h1>
                <h2 className="text-xl text-blue-800">{config.tituloFormulario}</h2>
              </>
            )}
          </div>

          {/* Dados do servidor */}
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 bg-gray-50 rounded-lg">
            {Object.entries(dados).map(([key, value]) => (
              <div key={key}>
                <label className="block text-sm font-semibold mb-1 capitalize">
                  {key === 'intersticio' ? 'Interst√≠cio' : key}:
                </label>
                <input
                  type="text"
                  value={value}
                  onChange={(e) => setDados({...dados, [key]: e.target.value})}
                  className="w-full px-3 py-2 border rounded"
                  placeholder={`Digite ${key}`}
                />
              </div>
            ))}
          </div>

          {/* Renderiza√ß√£o dos Quadros */}
          {quadros.length === 0 && modoEdicao && (
            <div className="text-center py-12 bg-gray-50 rounded-lg mb-6">
              <p className="text-gray-600 text-lg mb-4">Nenhum quadro criado ainda</p>
              <div className="flex gap-4 justify-center">
                <button
                  onClick={() => addQuadro(true)}
                  className="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold flex items-center gap-2"
                >
                  <Icons.Table /> Completo
                </button>
                <button
                  onClick={() => addQuadro(false)}
                  className="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold flex items-center gap-2"
                >
                  <Icons.Plus /> {config.rotulosPorTempo.nomeQuadro}
                </button>
              </div>
            </div>
          )}

          {quadros.map((quadro) => (
            <div key={quadro.id} className="mb-6 bg-white rounded-lg shadow-md p-4 border-2 border-blue-900 quadro-container">
              {/* Cabe√ßalho do Quadro */}
              <div className="bg-blue-900 text-white p-3 font-bold flex justify-between items-center rounded-lg mb-3">
                <div className="flex items-center gap-3 flex-1">
                  {modoEdicao ? (
                    <input
                      type="text"
                      value={quadro.titulo}
                      onChange={(e) => editQuadro(quadro.id, 'titulo', e.target.value)}
                      className="flex-1 px-3 py-2 rounded border text-black font-bold text-lg"
                      placeholder="T√≠tulo do quadro"
                    />
                  ) : (
                    <span className="text-lg">{quadro.titulo}</span>
                  )}
                  {modoEdicao && (
                    <span className={`text-xs px-2 py-1 rounded ${quadro.temColunas ? 'bg-blue-700' : 'bg-green-700'}`}>
                      {quadro.temColunas ? 'Completo' : config.rotulosPorTempo.nomeQuadro}
                    </span>
                  )}
                </div>
                
                {modoEdicao && (
                  <div className="flex gap-2 ml-3 no-print">
                    <button
                      onClick={() => toggleColunas(quadro.id)}
                      className="bg-yellow-600 hover:bg-yellow-500 px-3 py-1 rounded text-sm flex items-center gap-1"
                      title={quadro.temColunas ? `Mudar para ${config.rotulosPorTempo.nomeQuadro}` : "Mudar para Completo"}
                    >
                      <Icons.Table /> {quadro.temColunas ? config.rotulosPorTempo.nomeQuadro : 'Completo'}
                    </button>
                    <button
                      onClick={() => addCriterio(quadro.id)}
                      className="bg-blue-700 hover:bg-blue-600 px-3 py-1 rounded text-sm flex items-center gap-1"
                      title="Adicionar crit√©rio"
                    >
                      <Icons.Plus /> Crit√©rio
                    </button>
                    <button
                      onClick={() => duplicarQuadro(quadro.id)}
                      className="bg-green-700 hover:bg-green-600 px-3 py-1 rounded text-sm flex items-center gap-1"
                      title="Duplicar quadro"
                    >
                      <Icons.Copy />
                    </button>
                    <button
                      onClick={() => removeQuadro(quadro.id)}
                      className="bg-red-600 hover:bg-red-700 px-3 py-1 rounded text-sm flex items-center gap-1"
                      title="Excluir quadro"
                    >
                      <Icons.Trash2 />
                    </button>
                  </div>
                )}
              </div>

              {/* Conte√∫do do Quadro - COM COLUNAS COMPLETAS */}
              {quadro.temColunas ? (
                <div className="overflow-x-auto">
                  <table className="w-full border-collapse border text-xs">
                    <thead className="bg-gray-200">
                      <tr>
                        <th className="border p-2" style={{width: '30%'}}>{config.rotulosCompleto.criterio}</th>
                        <th className="border p-2" style={{width: '9%'}}>{config.rotulosCompleto.pontUnit}</th>
                        <th className="border p-2" style={{width: '9%'}}>{config.rotulosCompleto.limite}</th>
                        <th className="border p-2" style={{width: '9%'}}>{config.rotulosCompleto.qtd}</th>
                        <th className="border p-2" style={{width: '9%'}}>{config.rotulosCompleto.meses}</th>
                        <th className="border p-2" style={{width: '9%'}}>{config.rotulosCompleto.base}</th>
                        <th className="border p-2" style={{width: '9%'}}>{config.rotulosCompleto.mult}</th>
                        <th className="border p-2" style={{width: '10%'}}>{config.rotulosCompleto.total}</th>
                        {modoEdicao && <th className="border p-2 no-print" style={{width: 'auto'}}>A√ß√µes</th>}
                      </tr>
                    </thead>
                    <tbody>
                      {quadro.criterios.length === 0 && (
                        <tr>
                          <td colSpan={modoEdicao ? 9 : 8} className="p-4 text-center text-gray-500">
                            Nenhum crit√©rio neste quadro
                            {modoEdicao && (
                              <button
                                onClick={() => addCriterio(quadro.id)}
                                className="ml-3 px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm"
                              >
                                Adicionar Crit√©rio
                              </button>
                            )}
                          </td>
                        </tr>
                      )}
                      {quadro.criterios.map((crit, idx) => {
                        const calc = calcularCriterio(crit);
                        return (
                          <tr key={crit.id}>
                            <td className="border p-2">
                              <div className="flex items-center gap-2">
                                <span className="text-blue-900 font-bold">{idx + 1}.</span>
                                {modoEdicao ? (
                                  <input
                                    type="text"
                                    value={crit.nome}
                                    onChange={(e) => editCriterio(quadro.id, crit.id, 'nome', e.target.value)}
                                    className="flex-1 px-2 py-1 border rounded"
                                  />
                                ) : (
                                  <span>{crit.nome}</span>
                                )}
                              </div>
                            </td>
                            <td className="border p-2 text-center">
                              {modoEdicao ? (
                                <input
                                  type="number"
                                  step="0.1"
                                  value={crit.pont}
                                  onChange={(e) => editCriterio(quadro.id, crit.id, 'pont', e.target.value)}
                                  className="w-full px-2 py-1 border rounded text-center"
                                />
                              ) : (
                                <span>{parseFloat(crit.pont || 0).toFixed(1)}</span>
                              )}
                            </td>
                            <td className="border p-2 text-center">
                              {modoEdicao ? (
                                <input
                                  type="number"
                                  step="0.1"
                                  value={crit.lim}
                                  onChange={(e) => editCriterio(quadro.id, crit.id, 'lim', e.target.value)}
                                  className="w-full px-2 py-1 border rounded text-center"
                                />
                              ) : (
                                <span>{parseFloat(crit.lim || 0).toFixed(1)}</span>
                              )}
                            </td>
                            <td className="border p-2 text-center">
                              <input
                                type="number"
                                step="1"
                                value={crit.qtd}
                                onChange={(e) => editCriterio(quadro.id, crit.id, 'qtd', e.target.value)}
                                className="w-full px-2 py-1 border rounded text-center"
                              />
                            </td>
                            <td className="border p-2 text-center">
                              <input
                                type="number"
                                step="1"
                                value={crit.meses}
                                onChange={(e) => editCriterio(quadro.id, crit.id, 'meses', e.target.value)}
                                className="w-full px-2 py-1 border rounded text-center"
                              />
                            </td>
                            <td className="border p-2 text-center font-semibold">
                              {calc.ptsBase.toFixed(1)}
                            </td>
                            <td className="border p-2 text-center font-semibold">
                              {calc.ptsMeses.toFixed(1)}
                            </td>
                            <td className="border p-2 text-center font-bold text-blue-900">
                              {calc.total.toFixed(1)}
                            </td>
                            {modoEdicao && (
                              <td className="border p-2 text-center no-print">
                                <button
                                  onClick={() => removeCriterio(quadro.id, crit.id)}
                                  className="px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-xs flex items-center gap-1 mx-auto"
                                >
                                  <Icons.Trash2 />
                                </button>
                              </td>
                            )}
                          </tr>
                        );
                      })}
                      {quadro.criterios.length > 0 && (
                        <tr className="bg-yellow-100 font-bold">
                          <td colSpan={7} className="p-2 text-right">TOTAL DO QUADRO:</td>
                          <td className="p-2 text-center text-lg text-blue-900">
                            {calcularTotalQuadro(quadro).toFixed(1)}
                          </td>
                          {modoEdicao && <td className="no-print"></td>}
                        </tr>
                      )}
                    </tbody>
                  </table>
                </div>
              ) : (
                // Conte√∫do do Quadro - COM COLUNAS POR TEMPO
                <div className="overflow-x-auto">
                  <table className="w-full border-collapse border text-xs">
                    <thead className="bg-gray-200">
                      <tr>
                        <th className="border p-2" style={{width: '40%'}}>{config.rotulosPorTempo.criterio}</th>
                        <th className="border p-2" style={{width: '15%'}}>{config.rotulosPorTempo.pontTempo}</th>
                        <th className="border p-2" style={{width: '15%'}}>{config.rotulosPorTempo.limite}</th>
                        <th className="border p-2" style={{width: '15%'}}>{config.rotulosPorTempo.qtdTempo}</th>
                        <th className="border p-2" style={{width: '15%'}}>{config.rotulosPorTempo.total}</th>
                        {modoEdicao && <th className="border p-2 no-print" style={{width: 'auto'}}>A√ß√µes</th>}
                      </tr>
                    </thead>
                    <tbody>
                      {quadro.criterios.length === 0 && (
                        <tr>
                          <td colSpan={modoEdicao ? 6 : 5} className="p-4 text-center text-gray-500">
                            Nenhum crit√©rio neste quadro
                            {modoEdicao && (
                              <button
                                onClick={() => addCriterio(quadro.id)}
                                className="ml-3 px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm"
                              >
                                Adicionar Crit√©rio
                              </button>
                            )}
                          </td>
                        </tr>
                      )}
                      {quadro.criterios.map((crit, idx) => {
                        const total = calcularCriterioPorTempo(crit);
                        return (
                          <tr key={crit.id}>
                            <td className="border p-2">
                              <div className="flex items-center gap-2">
                                <span className="text-blue-900 font-bold">{idx + 1}.</span>
                                {modoEdicao ? (
                                  <input
                                    type="text"
                                    value={crit.nome}
                                    onChange={(e) => editCriterio(quadro.id, crit.id, 'nome', e.target.value)}
                                    className="flex-1 px-2 py-1 border rounded"
                                  />
                                ) : (
                                  <span>{crit.nome}</span>
                                )}
                              </div>
                            </td>
                            <td className="border p-2 text-center">
                              {modoEdicao ? (
                                <input
                                  type="number"
                                  step="0.1"
                                  value={crit.pontTempo}
                                  onChange={(e) => editCriterio(quadro.id, crit.id, 'pontTempo', e.target.value)}
                                  className="w-full px-2 py-1 border rounded text-center"
                                />
                              ) : (
                                <span>{parseFloat(crit.pontTempo || 0).toFixed(1)}</span>
                              )}
                            </td>
                            <td className="border p-2 text-center">
                              {modoEdicao ? (
                                <input
                                  type="number"
                                  step="0.1"
                                  value={crit.limItem}
                                  onChange={(e) => editCriterio(quadro.id, crit.id, 'limItem', e.target.value)}
                                  className="w-full px-2 py-1 border rounded text-center"
                                />
                              ) : (
                                <span>{parseFloat(crit.limItem || 0).toFixed(1)}</span>
                              )}
                            </td>
                            <td className="border p-2 text-center">
                              <input
                                type="number"
                                step="0.1"
                                value={crit.qtdTempo}
                                onChange={(e) => editCriterio(quadro.id, crit.id, 'qtdTempo', e.target.value)}
                                className="w-full px-2 py-1 border rounded text-center"
                              />
                            </td>
                            <td className="border p-2 text-center font-bold text-blue-900">
                              {total.toFixed(1)}
                            </td>
                            {modoEdicao && (
                              <td className="border p-2 text-center no-print">
                                <button
                                  onClick={() => removeCriterio(quadro.id, crit.id)}
                                  className="px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-xs flex items-center gap-1 mx-auto"
                                >
                                  <Icons.Trash2 />
                                </button>
                              </td>
                            )}
                          </tr>
                        );
                      })}
                      {quadro.criterios.length > 0 && (
                        <tr className="bg-yellow-100 font-bold">
                          <td colSpan={4} className="p-2 text-right">TOTAL DO QUADRO:</td>
                          <td className="p-2 text-center text-lg text-blue-900">
                            {calcularTotalQuadro(quadro).toFixed(1)}
                          </td>
                          {modoEdicao && <td className="no-print"></td>}
                        </tr>
                      )}
                    </tbody>
                  </table>
                </div>
              )}

              {/* Limite do Quadro */}
              <div className="mt-3 p-3 bg-gray-50 rounded-lg border-2 border-gray-300">
                <div className="flex items-center gap-3">
                  <label className="font-bold text-gray-700">Limite do Quadro:</label>
                  {modoEdicao ? (
                    <input
                      type="text"
                      value={quadro.limiteQuadro}
                      onChange={(e) => editQuadro(quadro.id, 'limiteQuadro', e.target.value)}
                      className="flex-1 px-3 py-2 border rounded"
                      placeholder="Ex: 30.0 pontos, ou deixe em branco"
                    />
                  ) : (
                    <span className="flex-1 text-blue-900 font-semibold">
                      {quadro.limiteQuadro || '(N√£o especificado)'}
                    </span>
                  )}
                </div>
              </div>

              {/* Bot√£o adicionar crit√©rio (inferior) */}
              {modoEdicao && quadro.criterios.length > 0 && (
                <button
                  onClick={() => addCriterio(quadro.id)}
                  className={`mt-3 w-full py-2 ${
                    quadro.temColunas ? 'bg-blue-100 hover:bg-blue-200 text-blue-900' : 'bg-green-100 hover:bg-green-200 text-green-900'
                  } rounded flex items-center justify-center gap-2 font-semibold no-print`}
                >
                  <Icons.Plus /> Adicionar Crit√©rio
                </button>
              )}
            </div>
          ))}

          {/* NOVO: Total Geral do Formul√°rio */}
          <div className="mt-6 bg-gradient-to-r from-blue-900 to-blue-800 text-white rounded-lg shadow-xl p-6 border-4 border-blue-700 total-geral-container">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-4">
                <div className="text-4xl hide-on-print">üéØ</div>
                <div>
                  <h3 className="text-sm font-semibold uppercase tracking-wide opacity-90">Total Geral do Formul√°rio</h3>
                  <div className="flex items-baseline gap-3 mt-1">
                    <span className="text-4xl font-bold">{calcularTotalGeral().toFixed(1)}</span>
                    <span className="text-2xl opacity-75">/</span>
                    <span className="text-3xl font-semibold">{config.limiteTotal.toFixed(1)}</span>
                    <span className="text-lg opacity-75">pontos</span>
                  </div>
                </div>
              </div>
              {calcularTotalGeral() > config.limiteTotal && (
                <div className="bg-yellow-500 text-yellow-900 px-4 py-2 rounded-lg font-bold flex items-center gap-2 hide-on-print">
                  ‚ö†Ô∏è Limite excedido
                </div>
              )}
            </div>
          </div>

        </div>

        {/* Instru√ß√µes de uso */}
        {modoEdicao && (
          <div className="mt-6 bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded no-print">
            <h3 className="font-bold text-yellow-900 mb-2">Como usar este editor:</h3>
            <ul className="text-sm text-yellow-800 space-y-1 list-disc list-inside">
              <li><strong>Quadro Completo:</strong> Colunas: Pont. Unit., Limite, Qtd, Meses - Calcula Base, Mult. e Total automaticamente</li>
              <li><strong>Quadro {config.rotulosPorTempo.nomeQuadro}:</strong> Colunas: {config.rotulosPorTempo.pontTempo}, Limite, {config.rotulosPorTempo.qtdTempo} - Calcula Total = min(Pont √ó Tempo, Limite)</li>
              <li><strong>Alternar Tipo:</strong> Use o bot√£o para mudar entre "Completo" e "{config.rotulosPorTempo.nomeQuadro}"</li>
              <li><strong>Limite do Quadro:</strong> Campo opcional no final de cada quadro para especificar limite m√°ximo</li>
              <li><strong>Total Geral:</strong> Calculado automaticamente e comparado com o limite de {config.limiteTotal} pontos</li>
              <li><strong>Duplicar:</strong> Copia o quadro completo com todos os crit√©rios e valores</li>
              <li><strong>Nomenclaturas Edit√°veis:</strong> Configure todos os r√≥tulos em "Configura√ß√µes" ‚Üí "Configurar R√≥tulos das Colunas"</li>
              <li><strong>Impress√£o A4:</strong> Use o bot√£o "Imprimir" para gerar PDF otimizado em uma folha √∫nica</li>
            </ul>
          </div>
        )}
      </div>
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<FormularioCV />);
    </script>
</body>
</html>
