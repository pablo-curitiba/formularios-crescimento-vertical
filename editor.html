<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Formul√°rio - Crescimento Vertical 2025</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
const { useState, useEffect } = React;

// √çcones SVG inline
const Icons = {
  Download: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
      <polyline points="7 10 12 15 17 10"></polyline>
      <line x1="12" y1="15" x2="12" y2="3"></line>
    </svg>
  ),
  Edit2: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
    </svg>
  ),
  Save: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
      <polyline points="17 21 17 13 7 13 7 21"></polyline>
      <polyline points="7 3 7 8 15 8"></polyline>
    </svg>
  ),
  Plus: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <line x1="12" y1="5" x2="12" y2="19"></line>
      <line x1="5" y1="12" x2="19" y2="12"></line>
    </svg>
  ),
  Trash2: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <polyline points="3 6 5 6 21 6"></polyline>
      <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
      <line x1="10" y1="11" x2="10" y2="17"></line>
      <line x1="14" y1="11" x2="14" y2="17"></line>
    </svg>
  ),
  Info: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="12" y1="16" x2="12" y2="12"></line>
      <line x1="12" y1="8" x2="12.01" y2="8"></line>
    </svg>
  ),
  FileText: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
      <polyline points="14 2 14 8 20 8"></polyline>
      <line x1="16" y1="13" x2="8" y2="13"></line>
      <line x1="16" y1="17" x2="8" y2="17"></line>
      <polyline points="10 9 9 9 8 9"></polyline>
    </svg>
  ),
  Printer: (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <polyline points="6 9 6 2 18 2 18 9"></polyline>
      <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
      <rect x="6" y="14" width="12" height="8"></rect>
    </svg>
  )
};

function FormularioCV() {
  const [modoEdicao, setModoEdicao] = useState(false);
  const [mostrarInfoA, setMostrarInfoA] = useState(true);
  const [mostrarInfoB, setMostrarInfoB] = useState(true);
  
  // Estados para t√≠tulos edit√°veis dos quadros
  const [tituloQuadroA, setTituloQuadroA] = useState("QUADRO A - ESCOLARIZA√á√ÉO FORMAL (NA √ÅREA DE ATUA√á√ÉO)");
  const [tituloQuadroB, setTituloQuadroB] = useState("QUADRO B - ESCOLARIZA√á√ÉO FORMAL (EM QUALQUER √ÅREA - COMPLEMENTAR)");
  const [tituloQuadroC, setTituloQuadroC] = useState("QUADRO C - VIDA FUNCIONAL");
  const [tituloQuadroD, setTituloQuadroD] = useState("QUADRO D - OUTROS CRIT√âRIOS OBJETIVOS");
  const [tituloQuadroE, setTituloQuadroE] = useState("QUADRO E - DEDU√á√ïES");
  
  // Estados para mostrar/ocultar quadros
  const [mostrarQuadroA, setMostrarQuadroA] = useState(true);
  const [mostrarQuadroB, setMostrarQuadroB] = useState(true);
  const [mostrarQuadroC, setMostrarQuadroC] = useState(true);
  const [mostrarQuadroD, setMostrarQuadroD] = useState(true);
  const [mostrarQuadroE, setMostrarQuadroE] = useState(true);
  
  const [config, setConfig] = useState({
    lei: '16.198/2023',
    grupoOcupacional: 'B√ÅSICO',
    requisitoMinimo: 5.0,
    tituloPrincipal: 'PREFEITURA MUNICIPAL DE CURITIBA',
    tituloFormulario: 'FORMUL√ÅRIO DO CRESCIMENTO VERTICAL 2025',
    ingressoLei16201: ''
  });
  
  const [dados, setDados] = useState({
    servidor: '',
    matricula: '',
    cargo: '',
    unidade: '',
    lotacao: '',
    intersticio: ''
  });

  const [porNivel, setPorNivel] = useState(false);
  const [nivelSelecionado, setNivelSelecionado] = useState('N√≠vel I');

  const [multiplicador] = useState({
    pontosPorMes: 0.0556,
    limiteMax: 10.0
  });

  const leisDisponiveis = [
    { valor: '16.198/2023', cargo: '' },
    { valor: '16.199/2023', cargo: 'Auditor Fiscal' },
    { valor: '16.200/2023', cargo: 'Procurador Municipal' },
    { valor: '16.201/2023', cargo: 'Professor de Educa√ß√£o Infantil' },
    { valor: '16.202/2023', cargo: 'Profissional do Magist√©rio' },
    { valor: '16.203/2023', cargo: 'Guarda Municipal' }
  ];

  const handleLeiChange = (novaLei) => {
    const leiSelecionada = leisDisponiveis.find(l => l.valor === novaLei);
    const novoConfig = {...config, lei: novaLei};
    
    if (novaLei !== '16.201/2023') {
      novoConfig.ingressoLei16201 = '';
    }
    
    setConfig(novoConfig);
    if (leiSelecionada) {
      setDados({...dados, cargo: leiSelecionada.cargo});
    }
  };

  const pareamentoAB = {
    'medio-tecnico': { quadroA: 2, quadroB: 1, nome: 'M√©dio-T√©cnico' },
    'graduacao': { quadroA: 3, quadroB: 2, nome: 'Gradua√ß√£o' },
    'extensao': { quadroA: 4, quadroB: 3, nome: 'Extens√£o Universit√°ria' },
    'especializacao': { quadroA: 5, quadroB: 4, nome: 'Especializa√ß√£o' },
    'mestrado': { quadroA: 6, quadroB: 5, nome: 'Mestrado' },
    'doutorado': { quadroA: 7, quadroB: 6, nome: 'Doutorado' }
  };

  const [quadroA, setQuadroA] = useState([
    { id: 1, titulo: 'Cursos de Educa√ß√£o formal de n√≠vel m√©dio', pont: 5.0, lim: 5.0, qtd: 0, meses: 0 },
    { id: 2, titulo: 'Cursos de Educa√ß√£o formal de n√≠vel m√©dio-t√©cnico - Na √°rea de atua√ß√£o', pont: 7.5, lim: 15.0, qtd: 0, meses: 0 },
    { id: 3, titulo: 'N√≠vel Superior Gradua√ß√£o - Na √°rea de atua√ß√£o', pont: 15.0, lim: 15.0, qtd: 0, meses: 0 },
    { id: 4, titulo: 'Cursos de Extens√£o Universit√°ria - Na √°rea de atua√ß√£o', pont: 1.0, lim: 10.0, qtd: 0, meses: 0 },
    { id: 5, titulo: 'P√≥s-Gradua√ß√£o Especializa√ß√£o - Na √°rea de atua√ß√£o', pont: 10.0, lim: 30.0, qtd: 0, meses: 0 },
    { id: 6, titulo: 'P√≥s-Gradua√ß√£o Stricto Sensu Mestrado - Na √°rea de atua√ß√£o', pont: 22.0, lim: 22.0, qtd: 0, meses: 0 },
    { id: 7, titulo: 'P√≥s-Gradua√ß√£o Stricto Sensu Doutorado - Na √°rea de atua√ß√£o', pont: 33.0, lim: 33.0, qtd: 0, meses: 0 }
  ]);

  const [quadroB, setQuadroB] = useState([
    { id: 1, titulo: 'Cursos de Educa√ß√£o formal de n√≠vel m√©dio-t√©cnico - Em qualquer √°rea', pont: 5.5, lim: 15.0, qtd: 0, meses: 0 },
    { id: 2, titulo: 'N√≠vel Superior Gradua√ß√£o - Em qualquer √°rea', pont: 10.0, lim: 15.0, qtd: 0, meses: 0 },
    { id: 3, titulo: 'Cursos de Extens√£o Universit√°ria - Em qualquer √°rea', pont: 0.5, lim: 10.0, qtd: 0, meses: 0 },
    { id: 4, titulo: 'P√≥s-Gradua√ß√£o Especializa√ß√£o - Em qualquer √°rea', pont: 7.5, lim: 30.0, qtd: 0, meses: 0 },
    { id: 5, titulo: 'P√≥s-Gradua√ß√£o Stricto Sensu Mestrado - Em qualquer √°rea', pont: 17.0, lim: 22.0, qtd: 0, meses: 0 },
    { id: 6, titulo: 'P√≥s-Gradua√ß√£o Stricto Sensu Doutorado - Em qualquer √°rea', pont: 25.5, lim: 33.0, qtd: 0, meses: 0 }
  ]);

  const [quadroC, setQuadroC] = useState([
    { id: 1, titulo: 'Participa√ß√£o em comiss√£o permanente ou tempor√°ria institu√≠da pelo prefeito', pont: 0.05, lim: 3.0, qtd: 0, meses: 0 },
    { id: 2, titulo: 'Licita√ß√£o e contratos, participando da Comiss√£o de Licita√ß√£o, Comiss√£o Julgadora ou Pregoeiro, emitindo relat√≥rios, pareceres ou elaborando minutas', pont: 0.20, lim: 8.0, qtd: 0, meses: 0 },
    { id: 3, titulo: 'Controle Interno de Gest√£o de Recursos ou Controle Interno Geral', pont: 0.10, lim: 5.0, qtd: 0, meses: 0 },
    { id: 4, titulo: 'Participa√ß√£o em grupo de estudos ou grupo de trabalho criado pela PMC', pont: 0.05, lim: 3.0, qtd: 0, meses: 0 },
    { id: 5, titulo: 'Elogio formal emitido pela chefia imediata e/ou pela Administra√ß√£o superior', pont: 0.05, lim: 3.0, qtd: 0, meses: 0 }
  ]);

  const [quadroD, setQuadroD] = useState([
    { id: 1, titulo: 'Publica√ß√£o de artigos (em jornal, revista, plataforma digital ou ve√≠culo de comunica√ß√£o de massa)', pont: 0.5, lim: 8.0, qtd: 0 },
    { id: 2, titulo: 'Publica√ß√£o de livros (relacionados √† √°rea de atua√ß√£o)', pont: 2.0, lim: 8.0, qtd: 0 },
    { id: 3, titulo: 'Eventos cient√≠ficos na √°rea de atua√ß√£o (participa√ß√£o como coordenador, organizador, palestrante, painelista ou apresentador de trabalho)', pont: 1.0, lim: 8.0, qtd: 0 },
    { id: 4, titulo: 'Certificados de participa√ß√£o em eventos na √°rea de atua√ß√£o, tais como: confer√™ncias, congressos, semin√°rios, simp√≥sios, workshops, f√≥runs, palestras', pont: 0.5, lim: 8.0, qtd: 0 },
    { id: 5, titulo: 'Cursos profissionalizantes com dura√ß√£o m√≠nima de 20h', pont: 0.5, lim: 8.0, qtd: 0 },
    { id: 6, titulo: 'Participa√ß√£o em projetos de pesquisa e extens√£o', pont: 0.5, lim: 8.0, qtd: 0 },
    { id: 7, titulo: 'Desenvolvimento, implementa√ß√£o e/ou execu√ß√£o de projeto aprovado pela Administra√ß√£o, relacionado √† √°rea de atua√ß√£o do servidor', pont: 2.0, lim: 8.0, qtd: 0 },
    { id: 8, titulo: 'Monitoria, orienta√ß√£o ou doc√™ncia em cursos realizados no √¢mbito da PMC', pont: 1.0, lim: 8.0, qtd: 0 },
    { id: 9, titulo: 'Aprova√ß√£o em concurso p√∫blico de n√≠vel superior para cargo permanente realizado no Brasil', pont: 1.0, lim: 8.0, qtd: 0 }
  ]);

  const [quadroE, setQuadroE] = useState([
    { id: 1, titulo: 'Faltas injustificadas', pont: -1.0, lim: -3.0, qtd: 0 }
  ]);

  // Fun√ß√£o atualizar CORRIGIDA - n√£o converte para n√∫mero no onChange
  const atualizar = (lista, setLista, id, campo, val) => {
    setLista(lista.map(i => i.id === id ? { ...i, [campo]: val } : i));
  };

  const remover = (lista, setLista, id) => {
    setLista(lista.filter(i => i.id !== id));
  };

  const addFinal = (lista, setLista, temMeses = true) => {
    const novoId = Math.max(...lista.map(i => i.id), 0) + 1;
    const novoItem = { id: novoId, titulo: '', pont: 0, lim: 0, qtd: 0 };
    if (temMeses) novoItem.meses = 0;
    setLista([...lista, novoItem]);
  };

  // C√°lculos do Quadro A - CORRIGIDO com parseFloat
  const calcA = quadroA.map(i => {
    const pont = parseFloat(i.pont || 0);
    const qtd = parseFloat(i.qtd || 0);
    const lim = parseFloat(i.lim || 0);
    const meses = parseFloat(i.meses || 0);
    
    const ptsBase = Math.min(pont * qtd, lim);
    const ptsMeses = Math.min(meses * multiplicador.pontosPorMes, multiplicador.limiteMax);
    const parcial = ptsBase + ptsMeses;
    return { ...i, ptsBase, ptsMeses, parcial };
  });

  const totalA = calcA.reduce((acc, i) => acc + i.parcial, 0);

  // C√°lculos do Quadro B - CORRIGIDO com parseFloat
  const calcB = quadroB.map(i => {
    const pont = parseFloat(i.pont || 0);
    const qtd = parseFloat(i.qtd || 0);
    const lim = parseFloat(i.lim || 0);
    const meses = parseFloat(i.meses || 0);
    
    const ptsBase = Math.min(pont * qtd, lim);
    const ptsMeses = Math.min(meses * multiplicador.pontosPorMes, multiplicador.limiteMax);
    const parcial = ptsBase + ptsMeses;
    return { ...i, ptsBase, ptsMeses, parcial };
  });

  const totalB = calcB.reduce((acc, i) => acc + i.parcial, 0);

  // Pareamento entre A e B
  const pareamentosAtivos = [];
  Object.entries(pareamentoAB).forEach(([key, par]) => {
    const itemA = calcA.find(i => i.id === par.quadroA);
    const itemB = calcB.find(i => i.id === par.quadroB);
    if (itemA && itemB) {
      const qtdA = parseFloat(itemA.qtd || 0);
      const qtdB = parseFloat(itemB.qtd || 0);
      if (qtdA > 0 && qtdB > 0) {
        const descartado = Math.min(itemB.ptsBase, itemA.ptsBase);
        pareamentosAtivos.push({ nome: par.nome, descartado, itemA, itemB });
      }
    }
  });

  const totalDescartadoB = pareamentosAtivos.reduce((acc, p) => acc + p.descartado, 0);
  const totalB_AposDescarte = totalB - totalDescartadoB;
  const totalAB = totalA + totalB_AposDescarte;

  // Limite total A+B
  let limiteAB_config = 50.0;
  if (config.lei === '16.201/2023') {
    if (config.ingressoLei16201 === 'sim') {
      limiteAB_config = 30.0;
    } else if (config.ingressoLei16201 === 'nao') {
      limiteAB_config = 43.0;
    }
  }

  const totalAB_ComLimite = Math.min(totalAB, limiteAB_config);

  // C√°lculos do Quadro C - CORRIGIDO com parseFloat
  const calcC = quadroC.map(i => {
    const pont = parseFloat(i.pont || 0);
    const qtd = parseFloat(i.qtd || 0);
    const lim = parseFloat(i.lim || 0);
    const meses = parseFloat(i.meses || 0);
    
    const ptsBase = pont * qtd;
    const ptsMeses = Math.min(meses * multiplicador.pontosPorMes, multiplicador.limiteMax);
    const ptsSemLimite = ptsBase + ptsMeses;
    const parcial = Math.min(ptsSemLimite, lim);
    const descartado = Math.max(0, ptsSemLimite - lim);
    return { ...i, ptsBase, ptsMeses, parcial, descartado };
  });

  const totalC_SemLimite = calcC.reduce((acc, i) => acc + i.ptsBase + i.ptsMeses, 0);
  const totalC = calcC.reduce((acc, i) => acc + i.parcial, 0);
  const totalC_Descartado = totalC_SemLimite - totalC;

  // C√°lculos do Quadro D - CORRIGIDO com parseFloat
  const calcD = quadroD.map(i => {
    const pont = parseFloat(i.pont || 0);
    const qtd = parseFloat(i.qtd || 0);
    const lim = parseFloat(i.lim || 0);
    
    const ptsSemLimite = pont * qtd;
    const parcial = Math.min(ptsSemLimite, lim);
    const descartado = Math.max(0, ptsSemLimite - lim);
    return { ...i, ptsSemLimite, parcial, descartado };
  });

  const totalD_SemLimite = calcD.reduce((acc, i) => acc + i.ptsSemLimite, 0);
  const totalD = Math.min(totalD_SemLimite, 8.0);
  const totalD_Descartado = Math.max(0, totalD_SemLimite - 8.0);

  // C√°lculos do Quadro E - CORRIGIDO com parseFloat
  const calcE = quadroE.map(i => {
    const pont = parseFloat(i.pont || 0);
    const qtd = parseFloat(i.qtd || 0);
    const lim = parseFloat(i.lim || 0);
    
    const ptsSemLimite = pont * qtd;
    const parcial = Math.max(ptsSemLimite, lim);
    return { ...i, ptsSemLimite, parcial };
  });

  const totalE_SemLimite = calcE.reduce((acc, i) => acc + i.ptsSemLimite, 0);
  const totalE = Math.max(totalE_SemLimite, -3.0);

  // Pontua√ß√£o final
  const pontuacaoFinal = totalAB_ComLimite + totalC + totalD + totalE;

  // Verificar se atinge requisito m√≠nimo
  const atingeRequisito = pontuacaoFinal >= config.requisitoMinimo;

  // Componente de linha gen√©rico
  function Linha({ item, lista, setLista, indice, mostrarDescartado = true, temMeses = true }) {
    const calc = temMeses 
      ? (lista === quadroC ? calcC.find(c => c.id === item.id) : 
         lista === quadroA ? calcA.find(c => c.id === item.id) :
         calcB.find(c => c.id === item.id))
      : (lista === quadroD ? calcD.find(c => c.id === item.id) :
         calcE.find(c => c.id === item.id));

    const descarte = (lista === quadroB && pareamentosAtivos.find(p => p.itemB.id === item.id))
      ? pareamentosAtivos.find(p => p.itemB.id === item.id).descartado
      : (mostrarDescartado && calc?.descartado) || 0;

    return (
      <tr>
        <td className="border p-2">
          {modoEdicao ? (
            <input
              type="text"
              value={item.titulo}
              onChange={(e) => atualizar(lista, setLista, item.id, 'titulo', e.target.value)}
              className="w-full px-2 py-1 border rounded"
            />
          ) : (
            <span>{indice}. {item.titulo}</span>
          )}
        </td>
        <td className="border p-2 text-center">
          {modoEdicao ? (
            <input
              type="number"
              step="0.1"
              value={item.pont}
              onChange={(e) => atualizar(lista, setLista, item.id, 'pont', e.target.value)}
              className="w-full px-2 py-1 border rounded text-center"
            />
          ) : (
            <span>{(parseFloat(item.pont || 0)).toFixed(1)}</span>
          )}
        </td>
        <td className="border p-2 text-center">
          {modoEdicao ? (
            <input
              type="number"
              step="0.1"
              value={item.lim}
              onChange={(e) => atualizar(lista, setLista, item.id, 'lim', e.target.value)}
              className="w-full px-2 py-1 border rounded text-center"
            />
          ) : (
            <span>{(parseFloat(item.lim || 0)).toFixed(1)}</span>
          )}
        </td>
        <td className="border p-2 text-center">
          <input
            type="number"
            step="1"
            value={item.qtd}
            onChange={(e) => atualizar(lista, setLista, item.id, 'qtd', e.target.value)}
            className="w-full px-2 py-1 border rounded text-center"
          />
        </td>
        <td className="border p-2 text-center font-bold">
          <div>{calc?.parcial?.toFixed(1) || '0.0'}</div>
          {descarte > 0 && (
            <div className="text-red-600 text-xs">(-{descarte.toFixed(1)} pareado)</div>
          )}
        </td>
        {modoEdicao && (
          <td className="border p-2 text-center no-print">
            <button
              onClick={() => remover(lista, setLista, item.id)}
              className="px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-xs flex items-center gap-1 mx-auto"
            >
              <Icons.Trash2 /> Excluir
            </button>
          </td>
        )}
      </tr>
    );
  }

  // Componente de linha com meses
  function LinhaComMeses({ item, lista, setLista, indice }) {
    const calc = lista === quadroC ? calcC.find(c => c.id === item.id) :
                 lista === quadroA ? calcA.find(c => c.id === item.id) :
                 calcB.find(c => c.id === item.id);

    const descarte = (lista === quadroB && pareamentosAtivos.find(p => p.itemB.id === item.id))
      ? pareamentosAtivos.find(p => p.itemB.id === item.id).descartado
      : 0;

    return (
      <tr>
        <td className="border p-2">
          {modoEdicao ? (
            <input
              type="text"
              value={item.titulo}
              onChange={(e) => atualizar(lista, setLista, item.id, 'titulo', e.target.value)}
              className="w-full px-2 py-1 border rounded"
            />
          ) : (
            <span>{indice}. {item.titulo}</span>
          )}
        </td>
        <td className="border p-2 text-center">
          {modoEdicao ? (
            <input
              type="number"
              step="0.1"
              value={item.pont}
              onChange={(e) => atualizar(lista, setLista, item.id, 'pont', e.target.value)}
              className="w-full px-2 py-1 border rounded text-center"
            />
          ) : (
            <span>{(parseFloat(item.pont || 0)).toFixed(1)}</span>
          )}
        </td>
        <td className="border p-2 text-center">
          {modoEdicao ? (
            <input
              type="number"
              step="0.1"
              value={item.lim}
              onChange={(e) => atualizar(lista, setLista, item.id, 'lim', e.target.value)}
              className="w-full px-2 py-1 border rounded text-center"
            />
          ) : (
            <span>{(parseFloat(item.lim || 0)).toFixed(1)}</span>
          )}
        </td>
        <td className="border p-2 text-center">
          <input
            type="number"
            step="1"
            value={item.qtd}
            onChange={(e) => atualizar(lista, setLista, item.id, 'qtd', e.target.value)}
            className="w-full px-2 py-1 border rounded text-center"
          />
        </td>
        <td className="border p-2 text-center">
          <input
            type="number"
            step="1"
            value={item.meses}
            onChange={(e) => atualizar(lista, setLista, item.id, 'meses', e.target.value)}
            className="w-full px-2 py-1 border rounded text-center"
          />
        </td>
        <td className="border p-2 text-center">
          <div className="text-xs">{calc?.ptsBase?.toFixed(1) || '0.0'}</div>
        </td>
        <td className="border p-2 text-center">
          <div className="text-xs">{calc?.ptsMeses?.toFixed(1) || '0.0'}</div>
        </td>
        <td className="border p-2 text-center font-bold">
          <div>{calc?.parcial?.toFixed(1) || '0.0'}</div>
          {descarte > 0 && (
            <div className="text-red-600 text-xs">(-{descarte.toFixed(1)} pareado)</div>
          )}
        </td>
        {modoEdicao && (
          <td className="border p-2 text-center no-print">
            <button
              onClick={() => remover(lista, setLista, item.id)}
              className="px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-xs flex items-center gap-1 mx-auto"
            >
              <Icons.Trash2 /> Excluir
            </button>
          </td>
        )}
      </tr>
    );
  }

  // Fun√ß√µes de exporta√ß√£o
  const exportarHTML = () => {
    const htmlContent = document.documentElement.outerHTML;
    const blob = new Blob([htmlContent], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `Formulario_CV_${dados.servidor || 'servidor'}_${new Date().toISOString().split('T')[0]}.html`;
    a.click();
    URL.revokeObjectURL(url);
  };

  const exportarJSON = () => {
    const data = {
      config,
      dados,
      quadroA,
      quadroB,
      quadroC,
      quadroD,
      quadroE,
      totais: {
        totalA,
        totalB,
        totalAB,
        totalAB_ComLimite,
        totalC,
        totalD,
        totalE,
        pontuacaoFinal
      }
    };
    const json = JSON.stringify(data, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `Formulario_CV_${dados.servidor || 'servidor'}_${new Date().toISOString().split('T')[0]}.json`;
    a.click();
    URL.revokeObjectURL(url);
  };

  const copiarTexto = () => {
    let texto = `${config.tituloPrincipal}\n`;
    texto += `${config.tituloFormulario}\n\n`;
    texto += `SERVIDOR: ${dados.servidor}\n`;
    texto += `MATR√çCULA: ${dados.matricula}\n`;
    texto += `CARGO: ${dados.cargo}\n`;
    texto += `UNIDADE: ${dados.unidade}\n`;
    texto += `LOTA√á√ÉO: ${dados.lotacao}\n`;
    texto += `INTERST√çCIO: ${dados.intersticio}\n\n`;
    texto += `PONTUA√á√ÉO FINAL: ${pontuacaoFinal.toFixed(2)} pontos\n`;
    texto += `${atingeRequisito ? 'ATENDE' : 'N√ÉO ATENDE'} ao requisito m√≠nimo de ${config.requisitoMinimo.toFixed(1)} pontos\n`;

    navigator.clipboard.writeText(texto).then(() => {
      alert('Texto copiado para a √°rea de transfer√™ncia!');
    });
  };

  const imprimir = () => {
    window.print();
  };

  return (
    <div className="min-h-screen bg-gray-100 py-8 px-4">
      <style>{`
        @media print {
          body { margin: 0; padding: 10px; background: white; }
          .no-print { display: none !important; }
          .hide-on-export { display: none !important; }
          .container { max-width: 100% !important; margin: 0 !important; padding: 0 !important; }
        }
      `}</style>

      <div className="max-w-7xl mx-auto">
        {/* Barra de ferramentas */}
        <div className="bg-white rounded-lg shadow-md p-4 mb-6 no-print">
          <div className="flex flex-wrap gap-3 items-center justify-between">
            <h1 className="text-2xl font-bold text-blue-900">Gerador de Formul√°rio - CV 2025</h1>
            <div className="flex flex-wrap gap-2">
              <button
                onClick={() => setModoEdicao(!modoEdicao)}
                className={`px-4 py-2 rounded font-semibold flex items-center gap-2 ${
                  modoEdicao ? 'bg-green-600 hover:bg-green-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'
                }`}
              >
                {modoEdicao ? <><Icons.Save /> Salvar</> : <><Icons.Edit2 /> Editar</>}
              </button>
              <button
                onClick={exportarHTML}
                className="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded font-semibold flex items-center gap-2"
              >
                <Icons.Download /> HTML
              </button>
              <button
                onClick={exportarJSON}
                className="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded font-semibold flex items-center gap-2"
              >
                <Icons.FileText /> JSON
              </button>
              <button
                onClick={copiarTexto}
                className="px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded font-semibold"
              >
                üìã Copiar Texto
              </button>
              <button
                onClick={imprimir}
                className="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded font-semibold flex items-center gap-2"
              >
                <Icons.Printer /> Imprimir
              </button>
            </div>
          </div>
        </div>

        {/* Configura√ß√µes */}
        {modoEdicao && (
          <div className="bg-white rounded-lg shadow-md p-4 mb-6 no-print">
            <h2 className="text-xl font-bold mb-4 text-blue-900">‚öôÔ∏è Configura√ß√µes do Formul√°rio</h2>
            
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label className="block text-sm font-semibold mb-1">T√≠tulo Principal:</label>
                <input
                  type="text"
                  value={config.tituloPrincipal}
                  onChange={(e) => setConfig({...config, tituloPrincipal: e.target.value})}
                  className="w-full px-3 py-2 border rounded"
                />
              </div>
              <div>
                <label className="block text-sm font-semibold mb-1">T√≠tulo do Formul√°rio:</label>
                <input
                  type="text"
                  value={config.tituloFormulario}
                  onChange={(e) => setConfig({...config, tituloFormulario: e.target.value})}
                  className="w-full px-3 py-2 border rounded"
                />
              </div>
              <div>
                <label className="block text-sm font-semibold mb-1">Lei:</label>
                <select
                  value={config.lei}
                  onChange={(e) => handleLeiChange(e.target.value)}
                  className="w-full px-3 py-2 border rounded"
                >
                  {leisDisponiveis.map(l => (
                    <option key={l.valor} value={l.valor}>
                      {l.valor} {l.cargo && `- ${l.cargo}`}
                    </option>
                  ))}
                </select>
              </div>
              <div>
                <label className="block text-sm font-semibold mb-1">Grupo Ocupacional:</label>
                <select
                  value={config.grupoOcupacional}
                  onChange={(e) => setConfig({...config, grupoOcupacional: e.target.value})}
                  className="w-full px-3 py-2 border rounded"
                >
                  <option value="B√ÅSICO">B√ÅSICO</option>
                  <option value="M√âDIO">M√âDIO</option>
                  <option value="SUPERIOR">SUPERIOR</option>
                </select>
              </div>
              <div>
                <label className="block text-sm font-semibold mb-1">Requisito M√≠nimo (pontos):</label>
                <input
                  type="number"
                  step="0.1"
                  value={config.requisitoMinimo}
                  onChange={(e) => setConfig({...config, requisitoMinimo: parseFloat(e.target.value) || 0})}
                  className="w-full px-3 py-2 border rounded"
                />
              </div>
              {config.lei === '16.201/2023' && (
                <div>
                  <label className="block text-sm font-semibold mb-1">Ingressou ap√≥s Lei 16.201?</label>
                  <select
                    value={config.ingressoLei16201}
                    onChange={(e) => setConfig({...config, ingressoLei16201: e.target.value})}
                    className="w-full px-3 py-2 border rounded"
                  >
                    <option value="">Selecione</option>
                    <option value="sim">Sim (Limite: 30 pts)</option>
                    <option value="nao">N√£o (Limite: 43 pts)</option>
                  </select>
                </div>
              )}
            </div>
          </div>
        )}

        {/* Formul√°rio principal */}
        <div className="bg-white rounded-lg shadow-lg p-6">
          {/* Cabe√ßalho */}
          <div className="text-center mb-6 border-b-2 border-blue-900 pb-4">
            {modoEdicao ? (
              <>
                <input
                  type="text"
                  value={config.tituloPrincipal}
                  onChange={(e) => setConfig({...config, tituloPrincipal: e.target.value})}
                  className="text-2xl font-bold mb-2 w-full text-center border-b-2 border-blue-300 px-2 py-1"
                />
                <input
                  type="text"
                  value={config.tituloFormulario}
                  onChange={(e) => setConfig({...config, tituloFormulario: e.target.value})}
                  className="text-xl text-blue-800 w-full text-center border-b border-blue-200 px-2 py-1"
                />
              </>
            ) : (
              <>
                <h1 className="text-2xl font-bold mb-2">{config.tituloPrincipal}</h1>
                <h2 className="text-xl text-blue-800">{config.tituloFormulario}</h2>
              </>
            )}
          </div>

          {/* Dados do servidor */}
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 bg-gray-50 rounded-lg">
            {Object.entries(dados).map(([key, value]) => (
              <div key={key}>
                <label className="block text-sm font-semibold mb-1 capitalize">
                  {key === 'intersticio' ? 'Interst√≠cio' : key}:
                </label>
                <input
                  type="text"
                  value={value}
                  onChange={(e) => setDados({...dados, [key]: e.target.value})}
                  className="w-full px-3 py-2 border rounded"
                  placeholder={`Digite ${key}`}
                />
              </div>
            ))}
          </div>

          {/* Status de requisito */}
          <div className={`p-4 rounded-lg mb-6 text-center font-bold text-lg ${
            atingeRequisito ? 'bg-green-100 text-green-900' : 'bg-red-100 text-red-900'
          }`}>
            {atingeRequisito ? '‚úì' : '‚úó'} {atingeRequisito ? 'ATENDE' : 'N√ÉO ATENDE'} ao requisito m√≠nimo de {config.requisitoMinimo.toFixed(1)} pontos
          </div>

          {/* QUADRO A */}
          {mostrarQuadroA && (
            <div className="mb-6 bg-white rounded-lg shadow-md p-4 border-2 border-blue-900">
              <div className="bg-blue-900 text-white p-3 font-bold flex justify-between items-center rounded-lg mb-3">
                {modoEdicao ? (
                  <input
                    type="text"
                    value={tituloQuadroA}
                    onChange={(e) => setTituloQuadroA(e.target.value)}
                    className="w-full max-w-xl px-2 py-1 rounded border text-black"
                  />
                ) : (
                  <span>{tituloQuadroA}</span>
                )}
                <div className="flex gap-2 no-print">
                  <button
                    onClick={() => setMostrarInfoA(!mostrarInfoA)}
                    className="bg-blue-700 hover:bg-blue-600 px-3 py-1 rounded text-sm flex items-center gap-1"
                  >
                    <Icons.Info /> Info
                  </button>
                  {modoEdicao && (
                    <>
                      <button
                        onClick={() => addFinal(quadroA, setQuadroA, true)}
                        className="bg-blue-700 hover:bg-blue-600 px-3 py-1 rounded text-sm flex items-center gap-1"
                      >
                        <Icons.Plus /> Adicionar
                      </button>
                      <button
                        onClick={() => {
                          setQuadroA([]);
                          setMostrarQuadroA(false);
                        }}
                        className="px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm"
                      >
                        Excluir quadro
                      </button>
                    </>
                  )}
                </div>
              </div>

              {mostrarInfoA && (
                <div className="mb-3 p-3 bg-blue-50 border-l-4 border-blue-600 rounded text-sm hide-on-export">
                  <p className="font-bold text-blue-900 mb-1">‚ÑπÔ∏è Informa√ß√µes sobre o Quadro A:</p>
                  <p className="text-xs">Este quadro considera t√≠tulos na √°rea de atua√ß√£o. H√° pareamento com o Quadro B.</p>
                </div>
              )}

              <div className="overflow-x-auto">
                <table className="w-full border-collapse border text-xs">
                  <thead className="bg-gray-200">
                    <tr>
                      <th className="border p-2" style={{width: '35%'}}>T√≠tulo</th>
                      <th className="border p-2" style={{width: '8%'}}>Pont. Unit.</th>
                      <th className="border p-2" style={{width: '8%'}}>Limite</th>
                      <th className="border p-2" style={{width: '8%'}}>Qtd</th>
                      <th className="border p-2" style={{width: '8%'}}>Meses</th>
                      <th className="border p-2" style={{width: '8%'}}>Pts Base</th>
                      <th className="border p-2" style={{width: '8%'}}>Pts Meses</th>
                      <th className="border p-2" style={{width: '9%'}}>Total</th>
                      {modoEdicao && <th className="border p-2 no-print" style={{width: 'auto'}}>A√ß√µes</th>}
                    </tr>
                  </thead>
                  <tbody>
                    {quadroA.map((item, idx) => (
                      <LinhaComMeses key={item.id} item={item} lista={quadroA} setLista={setQuadroA} indice={idx + 1} />
                    ))}
                    <tr className="bg-yellow-100 font-bold">
                      <td colSpan={7} className="p-2 text-right">Total Quadro A:</td>
                      <td className="p-2 text-center text-lg">{totalA.toFixed(2)}</td>
                      {modoEdicao && <td className="no-print"></td>}
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          )}

          {/* QUADRO B */}
          {mostrarQuadroB && (
            <div className="mb-6 bg-white rounded-lg shadow-md p-4 border-2 border-blue-900">
              <div className="bg-blue-900 text-white p-3 font-bold flex justify-between items-center rounded-lg mb-3">
                {modoEdicao ? (
                  <input
                    type="text"
                    value={tituloQuadroB}
                    onChange={(e) => setTituloQuadroB(e.target.value)}
                    className="w-full max-w-xl px-2 py-1 rounded border text-black"
                  />
                ) : (
                  <span>{tituloQuadroB}</span>
                )}
                <div className="flex gap-2 no-print">
                  <button
                    onClick={() => setMostrarInfoB(!mostrarInfoB)}
                    className="bg-blue-700 hover:bg-blue-600 px-3 py-1 rounded text-sm flex items-center gap-1"
                  >
                    <Icons.Info /> Info
                  </button>
                  {modoEdicao && (
                    <>
                      <button
                        onClick={() => addFinal(quadroB, setQuadroB, true)}
                        className="bg-blue-700 hover:bg-blue-600 px-3 py-1 rounded text-sm flex items-center gap-1"
                      >
                        <Icons.Plus /> Adicionar
                      </button>
                      <button
                        onClick={() => {
                          setQuadroB([]);
                          setMostrarQuadroB(false);
                        }}
                        className="px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm"
                      >
                        Excluir quadro
                      </button>
                    </>
                  )}
                </div>
              </div>

              {mostrarInfoB && (
                <div className="mb-3 p-3 bg-yellow-50 border-l-4 border-yellow-600 rounded text-sm hide-on-export">
                  <p className="font-bold text-yellow-900 mb-1">‚ö†Ô∏è Informa√ß√µes sobre o Quadro B:</p>
                  <p className="text-xs mb-2">T√≠tulos em qualquer √°rea. Sistema de pareamento com Quadro A:</p>
                  <ul className="text-xs list-disc list-inside space-y-1">
                    {Object.entries(pareamentoAB).map(([key, par]) => (
                      <li key={key}>
                        <strong>{par.nome}:</strong> Se houver t√≠tulo no Quadro A (item {par.quadroA}) e no Quadro B (item {par.quadroB}), o menor valor dos pontos base ser√° descartado do Quadro B.
                      </li>
                    ))}
                  </ul>
                </div>
              )}

              {pareamentosAtivos.length > 0 && (
                <div className="mb-3 p-3 bg-orange-50 border-l-4 border-orange-600 rounded text-sm hide-on-export">
                  <p className="font-bold text-orange-900 mb-2">üîó Pareamentos Ativos:</p>
                  {pareamentosAtivos.map((p, i) => (
                    <div key={i} className="text-xs mb-1">
                      <strong>{p.nome}:</strong> Descartado {p.descartado.toFixed(1)} pts do Quadro B
                    </div>
                  ))}
                  <p className="text-xs font-bold mt-2">Total descartado do Quadro B: {totalDescartadoB.toFixed(1)} pts</p>
                </div>
              )}

              <div className="overflow-x-auto">
                <table className="w-full border-collapse border text-xs">
                  <thead className="bg-gray-200">
                    <tr>
                      <th className="border p-2" style={{width: '35%'}}>T√≠tulo</th>
                      <th className="border p-2" style={{width: '8%'}}>Pont. Unit.</th>
                      <th className="border p-2" style={{width: '8%'}}>Limite</th>
                      <th className="border p-2" style={{width: '8%'}}>Qtd</th>
                      <th className="border p-2" style={{width: '8%'}}>Meses</th>
                      <th className="border p-2" style={{width: '8%'}}>Pts Base</th>
                      <th className="border p-2" style={{width: '8%'}}>Pts Meses</th>
                      <th className="border p-2" style={{width: '9%'}}>Total</th>
                      {modoEdicao && <th className="border p-2 no-print" style={{width: 'auto'}}>A√ß√µes</th>}
                    </tr>
                  </thead>
                  <tbody>
                    {quadroB.map((item, idx) => (
                      <LinhaComMeses key={item.id} item={item} lista={quadroB} setLista={setQuadroB} indice={idx + 1} />
                    ))}
                    <tr className="bg-yellow-100 font-bold">
                      <td colSpan={7} className="p-2 text-right">Total Quadro B (antes pareamento):</td>
                      <td className="p-2 text-center text-lg">{totalB.toFixed(2)}</td>
                      {modoEdicao && <td className="no-print"></td>}
                    </tr>
                    <tr className="bg-orange-100 font-bold">
                      <td colSpan={7} className="p-2 text-right">Total Quadro B (ap√≥s pareamento):</td>
                      <td className="p-2 text-center text-lg">{totalB_AposDescarte.toFixed(2)}</td>
                      {modoEdicao && <td className="no-print"></td>}
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          )}

          {/* Totais A+B */}
          <div className="mb-6 bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 rounded-lg shadow-md">
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
              <div>
                <div className="text-sm opacity-90">Total A+B (sem limite)</div>
                <div className="text-2xl font-bold">{totalAB.toFixed(2)}</div>
              </div>
              <div>
                <div className="text-sm opacity-90">Limite configurado</div>
                <div className="text-2xl font-bold">{limiteAB_config.toFixed(1)}</div>
              </div>
              <div className="bg-white bg-opacity-20 rounded p-2">
                <div className="text-sm opacity-90">Total A+B (com limite)</div>
                <div className="text-3xl font-bold">{totalAB_ComLimite.toFixed(2)}</div>
              </div>
            </div>
          </div>

          {/* QUADRO C */}
          {mostrarQuadroC && (
            <div className="mb-6 bg-white rounded-lg shadow-md p-4 border-2 border-blue-900">
              <div className="bg-blue-900 text-white p-3 font-bold flex justify-between items-center rounded-lg mb-3">
                {modoEdicao ? (
                  <input
                    type="text"
                    value={tituloQuadroC}
                    onChange={(e) => setTituloQuadroC(e.target.value)}
                    className="w-full max-w-xl px-2 py-1 rounded border text-black"
                  />
                ) : (
                  <span>{tituloQuadroC}</span>
                )}
                <div className="flex gap-2 no-print">
                  {modoEdicao && (
                    <>
                      <button
                        onClick={() => addFinal(quadroC, setQuadroC, true)}
                        className="bg-blue-700 hover:bg-blue-600 px-3 py-1 rounded text-sm flex items-center gap-1"
                      >
                        <Icons.Plus /> Adicionar
                      </button>
                      <button
                        onClick={() => {
                          setQuadroC([]);
                          setMostrarQuadroC(false);
                        }}
                        className="px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm"
                      >
                        Excluir quadro
                      </button>
                    </>
                  )}
                </div>
              </div>

              <div className="overflow-x-auto">
                <table className="w-full border-collapse border text-xs">
                  <thead className="bg-gray-200">
                    <tr>
                      <th className="border p-2" style={{width: '35%'}}>Atividade</th>
                      <th className="border p-2" style={{width: '8%'}}>Pont. Unit.</th>
                      <th className="border p-2" style={{width: '8%'}}>Limite</th>
                      <th className="border p-2" style={{width: '8%'}}>Qtd</th>
                      <th className="border p-2" style={{width: '8%'}}>Meses</th>
                      <th className="border p-2" style={{width: '8%'}}>Pts Base</th>
                      <th className="border p-2" style={{width: '8%'}}>Pts Meses</th>
                      <th className="border p-2" style={{width: '9%'}}>Total</th>
                      {modoEdicao && <th className="border p-2 no-print" style={{width: 'auto'}}>A√ß√µes</th>}
                    </tr>
                  </thead>
                  <tbody>
                    {quadroC.map((item, idx) => (
                      <LinhaComMeses key={item.id} item={item} lista={quadroC} setLista={setQuadroC} indice={idx + 1} />
                    ))}
                    {totalC_Descartado > 0 && (
                      <tr className="bg-red-100">
                        <td colSpan={7} className="p-2 text-right text-red-700 font-semibold">
                          Pontos descartados (excederam limites individuais):
                        </td>
                        <td className="p-2 text-center text-red-700 font-bold">
                          -{totalC_Descartado.toFixed(1)}
                        </td>
                        {modoEdicao && <td className="no-print"></td>}
                      </tr>
                    )}
                    <tr className="bg-yellow-100 font-bold">
                      <td colSpan={7} className="p-2 text-right">Total Quadro C:</td>
                      <td className="p-2 text-center text-lg">{totalC.toFixed(1)}</td>
                      {modoEdicao && <td className="no-print"></td>}
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          )}

          {/* QUADRO D */}
          {mostrarQuadroD && (
            <div className="mb-6 bg-white rounded-lg shadow-md p-4 border-2 border-blue-900">
              <div className="bg-blue-900 text-white p-3 font-bold flex justify-between items-center rounded-lg mb-3">
                {modoEdicao ? (
                  <input
                    type="text"
                    value={tituloQuadroD}
                    onChange={(e) => setTituloQuadroD(e.target.value)}
                    className="w-full max-w-xl px-2 py-1 rounded border text-black"
                  />
                ) : (
                  <span>{tituloQuadroD}</span>
                )}
                <div className="flex gap-2 no-print">
                  {modoEdicao && (
                    <>
                      <button
                        onClick={() => addFinal(quadroD, setQuadroD, false)}
                        className="bg-blue-700 hover:bg-blue-600 px-3 py-1 rounded text-sm flex items-center gap-1"
                      >
                        <Icons.Plus /> Adicionar
                      </button>
                      <button
                        onClick={() => {
                          setQuadroD([]);
                          setMostrarQuadroD(false);
                        }}
                        className="px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm"
                      >
                        Excluir quadro
                      </button>
                    </>
                  )}
                </div>
              </div>

              {modoEdicao && (
                <div className="mb-3 p-3 bg-yellow-50 border-l-4 border-yellow-600 rounded hide-on-export">
                  <p className="font-bold text-yellow-900 mb-2">‚öôÔ∏è Itens Espec√≠ficos por Lei/Grupo:</p>
                  
                  {config.lei === '16.200/2023' && (
                    <div className="mb-3 p-2 bg-white rounded border border-yellow-400">
                      <label className="font-semibold text-sm block mb-2">Lei 16.200 - Procurador Municipal</label>
                      <button
                        onClick={() => {
                          const existe = quadroD.some(item => item.titulo.includes('Sustenta√ß√£o oral'));
                          if (existe) {
                            setQuadroD(quadroD.filter(item => !item.titulo.includes('Sustenta√ß√£o oral')));
                          } else {
                            const novoId = Math.max(...quadroD.map(i => i.id), 0) + 1;
                            setQuadroD([...quadroD, {
                              id: novoId,
                              titulo: 'Sustenta√ß√£o oral perante os tribunais',
                              pont: 0.5,
                              lim: 8.0,
                              qtd: 0
                            }]);
                          }
                        }}
                        className={`px-3 py-2 rounded text-sm font-semibold transition ${
                          quadroD.some(item => item.titulo.includes('Sustenta√ß√£o oral'))
                            ? 'bg-green-600 text-white hover:bg-red-600'
                            : 'bg-gray-300 text-gray-700 hover:bg-green-600 hover:text-white'
                        }`}
                      >
                        {quadroD.some(item => item.titulo.includes('Sustenta√ß√£o oral')) 
                          ? '‚úì Remover: Sustenta√ß√£o oral (0,5 pts / Lim: 8,0)'
                          : '+ Adicionar: Sustenta√ß√£o oral (0,5 pts / Lim: 8,0)'
                        }
                      </button>
                    </div>
                  )}

                  {config.lei === '16.198/2023' && config.grupoOcupacional === 'SUPERIOR' && (
                    <div className="mb-3 p-2 bg-white rounded border border-yellow-400">
                      <label className="font-semibold text-sm block mb-2">Lei 16.198 - Grupo SUPERIOR</label>
                      <button
                        onClick={() => {
                          const existe = quadroD.some(item => item.titulo.includes('ART') || item.titulo.includes('RRT'));
                          if (existe) {
                            setQuadroD(quadroD.filter(item => !(item.titulo.includes('ART') || item.titulo.includes('RRT'))));
                          } else {
                            const novoId = Math.max(...quadroD.map(i => i.id), 0) + 1;
                            setQuadroD([...quadroD, {
                              id: novoId,
                              titulo: 'Emiss√£o de ART (Anota√ß√£o de Responsabilidade T√©cnica) ou RRT (Registro de Responsabilidade T√©cnica), vinculadas a atividades desempenhadas no √¢mbito da PMC',
                              pont: 0.2,
                              lim: 8.0,
                              qtd: 0
                            }]);
                          }
                        }}
                        className={`px-3 py-2 rounded text-sm font-semibold transition ${
                          quadroD.some(item => item.titulo.includes('ART') || item.titulo.includes('RRT'))
                            ? 'bg-green-600 text-white hover:bg-red-600'
                            : 'bg-gray-300 text-gray-700 hover:bg-green-600 hover:text-white'
                        }`}
                      >
                        {quadroD.some(item => item.titulo.includes('ART') || item.titulo.includes('RRT'))
                          ? '‚úì Remover: ART/RRT (0,2 pts / Lim: 8,0)'
                          : '+ Adicionar: ART/RRT (0,2 pts / Lim: 8,0)'
                        }
                      </button>
                    </div>
                  )}

                  {config.lei !== '16.200/2023' && !(config.lei === '16.198/2023' && config.grupoOcupacional === 'SUPERIOR') && (
                    <p className="text-sm text-gray-600 italic">Nenhum item espec√≠fico dispon√≠vel para esta lei/grupo</p>
                  )}
                </div>
              )}

              <div className="overflow-x-auto">
                <table className="w-full border-collapse border text-xs">
                  <thead className="bg-gray-200">
                    <tr>
                      <th className="border p-2" style={{width: '50%'}}>Participa√ß√£o e Produ√ß√£o</th>
                      <th className="border p-2" style={{width: '12%'}}>Pont. Unit√°ria</th>
                      <th className="border p-2" style={{width: '12%'}}>Limite</th>
                      <th className="border p-2" style={{width: '13%'}}>Qtd</th>
                      <th className="border p-2" style={{width: '13%'}}>Total</th>
                      {modoEdicao && <th className="border p-2 no-print" style={{width: 'auto'}}>A√ß√µes</th>}
                    </tr>
                  </thead>
                  <tbody>
                    {quadroD.map((i, idx) => <Linha key={i.id} item={i} lista={quadroD} setLista={setQuadroD} indice={idx + 1} temMeses={false} />)}
                    {totalD_Descartado > 0 && (
                      <tr className="bg-red-100">
                        <td colSpan={4} className="p-2 text-right text-red-700 font-semibold">
                          Pontos descartados (excederam limite de 8,0 pts):
                        </td>
                        <td className="p-2 text-center text-red-700 font-bold">
                          -{totalD_Descartado.toFixed(1)}
                        </td>
                        {modoEdicao && <td className="no-print"></td>}
                      </tr>
                    )}
                    <tr className="bg-yellow-100 font-bold">
                      <td colSpan={4} className="p-2 text-right">Total Quadro D (Limite: 8,0 pts):</td>
                      <td className="p-2 text-center text-lg">{totalD.toFixed(1)}</td>
                      {modoEdicao && <td className="no-print"></td>}
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          )}

          {/* QUADRO E */}
          {mostrarQuadroE && (
            <div className="mb-6 bg-white rounded-lg shadow-md p-4 border-2 border-blue-900">
              <div className="bg-blue-900 text-white p-3 font-bold flex justify-between rounded-lg mb-2">
                {modoEdicao ? (
                  <input
                    type="text"
                    value={tituloQuadroE}
                    onChange={(e) => setTituloQuadroE(e.target.value)}
                    className="w-full max-w-xl px-2 py-1 rounded border text-black"
                  />
                ) : (
                  <span>{tituloQuadroE}</span>
                )}
                <div className="flex gap-2 no-print">
                  {modoEdicao && (
                    <>
                      <button
                        onClick={() => addFinal(quadroE, setQuadroE, false)}
                        className="bg-blue-700 hover:bg-blue-600 px-3 py-1 rounded text-sm flex items-center gap-1"
                      >
                        <Icons.Plus /> Adicionar
                      </button>
                      <button
                        onClick={() => {
                          setQuadroE([]);
                          setMostrarQuadroE(false);
                        }}
                        className="px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm"
                      >
                        Excluir quadro
                      </button>
                    </>
                  )}
                </div>
              </div>
              <div className="bg-red-50 border-l-4 border-red-600 p-3 mb-3 text-sm rounded hide-on-export">
                <p className="font-bold text-red-900">‚ö†Ô∏è ATEN√á√ÉO - L√≥gica de Dedu√ß√µes:</p>
                <p className="text-xs mt-1">Cada falta desconta 1 ponto. Limite m√°ximo de 3 faltas (-3 pontos).</p>
              </div>
              <div className="overflow-x-auto">
                <table className="w-full border-collapse border text-xs">
                  <thead className="bg-gray-200">
                    <tr>
                      <th className="border p-2" style={{width: '50%'}}>Dedu√ß√µes</th>
                      <th className="border p-2" style={{width: '12%'}}>Pont. Unit√°ria</th>
                      <th className="border p-2" style={{width: '12%'}}>Limite</th>
                      <th className="border p-2" style={{width: '13%'}}>Qtd</th>
                      <th className="border p-2" style={{width: '13%'}}>Total</th>
                      {modoEdicao && <th className="border p-2 no-print" style={{width: 'auto'}}>A√ß√µes</th>}
                    </tr>
                  </thead>
                  <tbody>
                    {quadroE.map((i, idx) => <Linha key={i.id} item={i} lista={quadroE} setLista={setQuadroE} indice={idx + 1} mostrarDescartado={false} temMeses={false} />)}
                    <tr className="bg-yellow-100 font-bold">
                      <td colSpan={4} className="p-2 text-right">Total Quadro E (Limite: -3,0 pts):</td>
                      <td className="p-2 text-center text-red-600 text-lg">{totalE.toFixed(1)}</td>
                      {modoEdicao && <td className="no-print"></td>}
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          )}

          {/* Pontua√ß√£o Final */}
          <div className="bg-gradient-to-r from-green-600 to-green-700 text-white p-6 text-center font-bold rounded-lg shadow-xl">
            <div className="text-3xl mb-3">
              PONTUA√á√ÉO FINAL: {pontuacaoFinal.toFixed(2)} pontos
            </div>
            <div className="text-sm font-normal bg-white bg-opacity-20 p-3 rounded">
              <div className="mb-1">(A+B + C + D) - E</div>
              <div>({totalAB_ComLimite.toFixed(2)} + {totalC.toFixed(1)} + {totalD.toFixed(1)}) - {Math.abs(totalE).toFixed(1)} = {pontuacaoFinal.toFixed(2)}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<FormularioCV />);
    </script>
</body>
</html>
